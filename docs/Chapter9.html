<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.531">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>비즈니스 애널리틱스 (Business Analytics) - 9&nbsp; 요인분석</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter10.html" rel="next">
<link href="./Chapter8.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter9.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">요인분석</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">비즈니스 애널리틱스 (Business Analytics)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">오리엔테이션</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">통계학의 본질과 변수의 이해</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">기술통계와 요약</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">일원배치 분산분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">이원배치 분산분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">회귀분석: 통계의 꽃</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">조절효과와 매개효과</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">차원축소와 주성분 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">요인분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">계층적 군집분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">k-평균 군집분석</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#요인분석의-개념" id="toc-요인분석의-개념" class="nav-link active" data-scroll-target="#요인분석의-개념"><span class="header-section-number">9.1</span> 요인분석의 개념</a>
  <ul class="collapse">
  <li><a href="#변수는-많지만-구조는-단순할-수-있다" id="toc-변수는-많지만-구조는-단순할-수-있다" class="nav-link" data-scroll-target="#변수는-많지만-구조는-단순할-수-있다"><span class="header-section-number">9.1.1</span> 변수는 많지만 구조는 단순할 수 있다</a></li>
  <li><a href="#주성분분석과-요인분석은-어떻게-다른가" id="toc-주성분분석과-요인분석은-어떻게-다른가" class="nav-link" data-scroll-target="#주성분분석과-요인분석은-어떻게-다른가"><span class="header-section-number">9.1.2</span> 주성분분석과 요인분석은 어떻게 다른가?</a></li>
  <li><a href="#분산의-구조로-비교해보자" id="toc-분산의-구조로-비교해보자" class="nav-link" data-scroll-target="#분산의-구조로-비교해보자"><span class="header-section-number">9.1.3</span> 분산의 구조로 비교해보자</a></li>
  <li><a href="#외식산업-사례로-비교해보자" id="toc-외식산업-사례로-비교해보자" class="nav-link" data-scroll-target="#외식산업-사례로-비교해보자"><span class="header-section-number">9.1.4</span> 외식산업 사례로 비교해보자</a></li>
  <li><a href="#수학적-표현으로-정리하면" id="toc-수학적-표현으로-정리하면" class="nav-link" data-scroll-target="#수학적-표현으로-정리하면"><span class="header-section-number">9.1.5</span> 수학적 표현으로 정리하면</a></li>
  <li><a href="#요인분석은-언제-사용하는가" id="toc-요인분석은-언제-사용하는가" class="nav-link" data-scroll-target="#요인분석은-언제-사용하는가"><span class="header-section-number">9.1.6</span> 요인분석은 언제 사용하는가?</a></li>
  <li><a href="#정리하면" id="toc-정리하면" class="nav-link" data-scroll-target="#정리하면"><span class="header-section-number">9.1.7</span> 정리하면</a></li>
  </ul></li>
  <li><a href="#요인추출-방법" id="toc-요인추출-방법" class="nav-link" data-scroll-target="#요인추출-방법"><span class="header-section-number">9.2</span> 요인추출 방법</a>
  <ul class="collapse">
  <li><a href="#왜-요인을-추출해야-하는가" id="toc-왜-요인을-추출해야-하는가" class="nav-link" data-scroll-target="#왜-요인을-추출해야-하는가"><span class="header-section-number">9.2.1</span> 왜 요인을 추출해야 하는가?</a></li>
  <li><a href="#paf의-기본-아이디어" id="toc-paf의-기본-아이디어" class="nav-link" data-scroll-target="#paf의-기본-아이디어"><span class="header-section-number">9.2.2</span> PAF의 기본 아이디어</a></li>
  <li><a href="#공통성의-의미" id="toc-공통성의-의미" class="nav-link" data-scroll-target="#공통성의-의미"><span class="header-section-number">9.2.3</span> 공통성의 의미</a></li>
  <li><a href="#외식산업-예제-커피전문점-만족도-요인-분석" id="toc-외식산업-예제-커피전문점-만족도-요인-분석" class="nav-link" data-scroll-target="#외식산업-예제-커피전문점-만족도-요인-분석"><span class="header-section-number">9.2.4</span> 외식산업 예제: 커피전문점 만족도 요인 분석</a></li>
  <li><a href="#r에서-paf-실행-예제" id="toc-r에서-paf-실행-예제" class="nav-link" data-scroll-target="#r에서-paf-실행-예제"><span class="header-section-number">9.2.5</span> R에서 PAF 실행 예제</a></li>
  <li><a href="#spss와-r의-차이점은" id="toc-spss와-r의-차이점은" class="nav-link" data-scroll-target="#spss와-r의-차이점은"><span class="header-section-number">9.2.6</span> SPSS와 R의 차이점은?</a></li>
  <li><a href="#마무리하며" id="toc-마무리하며" class="nav-link" data-scroll-target="#마무리하며"><span class="header-section-number">9.2.7</span> 마무리하며</a></li>
  </ul></li>
  <li><a href="#요인분석-결과-해석" id="toc-요인분석-결과-해석" class="nav-link" data-scroll-target="#요인분석-결과-해석"><span class="header-section-number">9.3</span> 요인분석 결과 해석</a>
  <ul class="collapse">
  <li><a href="#요인적재량factor-loading-변수와-요인-간의-관계" id="toc-요인적재량factor-loading-변수와-요인-간의-관계" class="nav-link" data-scroll-target="#요인적재량factor-loading-변수와-요인-간의-관계"><span class="header-section-number">9.3.1</span> 요인적재량(Factor loading): 변수와 요인 간의 관계</a></li>
  <li><a href="#공통성communality-요인들이-설명하는-변수의-분산-비율" id="toc-공통성communality-요인들이-설명하는-변수의-분산-비율" class="nav-link" data-scroll-target="#공통성communality-요인들이-설명하는-변수의-분산-비율"><span class="header-section-number">9.3.2</span> 공통성(Communality): 요인들이 설명하는 변수의 분산 비율</a></li>
  <li><a href="#고유값eigen-value-요인이-설명하는-총-분산" id="toc-고유값eigen-value-요인이-설명하는-총-분산" class="nav-link" data-scroll-target="#고유값eigen-value-요인이-설명하는-총-분산"><span class="header-section-number">9.3.3</span> 고유값(eigen value): 요인이 설명하는 총 분산</a></li>
  <li><a href="#설명된-총분산total-variance-explained-전체-데이터에서-요인이-설명하는-비율" id="toc-설명된-총분산total-variance-explained-전체-데이터에서-요인이-설명하는-비율" class="nav-link" data-scroll-target="#설명된-총분산total-variance-explained-전체-데이터에서-요인이-설명하는-비율"><span class="header-section-number">9.3.4</span> 설명된 총분산(Total Variance Explained): 전체 데이터에서 요인이 설명하는 비율</a></li>
  <li><a href="#varimax-회전-전후-결과-비교" id="toc-varimax-회전-전후-결과-비교" class="nav-link" data-scroll-target="#varimax-회전-전후-결과-비교"><span class="header-section-number">9.3.5</span> Varimax 회전 전후 결과 비교</a></li>
  <li><a href="#왜-varimax가-꼭-필요한가" id="toc-왜-varimax가-꼭-필요한가" class="nav-link" data-scroll-target="#왜-varimax가-꼭-필요한가"><span class="header-section-number">9.3.6</span> 왜 Varimax가 꼭 필요한가?</a></li>
  <li><a href="#문항별-요인구조의-비교와-해석-전략" id="toc-문항별-요인구조의-비교와-해석-전략" class="nav-link" data-scroll-target="#문항별-요인구조의-비교와-해석-전략"><span class="header-section-number">9.3.7</span> 문항별 요인구조의 비교와 해석 전략</a></li>
  <li><a href="#요인적합도-지표-해석" id="toc-요인적합도-지표-해석" class="nav-link" data-scroll-target="#요인적합도-지표-해석"><span class="header-section-number">9.3.8</span> 요인적합도 지표 해석</a></li>
  <li><a href="#외식산업-적용-사례-해석" id="toc-외식산업-적용-사례-해석" class="nav-link" data-scroll-target="#외식산업-적용-사례-해석"><span class="header-section-number">9.3.9</span> 외식산업 적용 사례 해석</a></li>
  <li><a href="#분석-코드-재확인" id="toc-분석-코드-재확인" class="nav-link" data-scroll-target="#분석-코드-재확인"><span class="header-section-number">9.3.10</span> 분석 코드 재확인</a></li>
  <li><a href="#r-vs-spss-요인분석-알고리즘-비교" id="toc-r-vs-spss-요인분석-알고리즘-비교" class="nav-link" data-scroll-target="#r-vs-spss-요인분석-알고리즘-비교"><span class="header-section-number">9.3.11</span> R vs SPSS 요인분석 알고리즘 비교</a></li>
  </ul></li>
  <li><a href="#요인점수란-무엇인가" id="toc-요인점수란-무엇인가" class="nav-link" data-scroll-target="#요인점수란-무엇인가"><span class="header-section-number">9.4</span> 요인점수란 무엇인가</a>
  <ul class="collapse">
  <li><a href="#수학적-표현과-개념적-구조" id="toc-수학적-표현과-개념적-구조" class="nav-link" data-scroll-target="#수학적-표현과-개념적-구조"><span class="header-section-number">9.4.1</span> 수학적 표현과 개념적 구조</a></li>
  <li><a href="#요인점수-계산-방식" id="toc-요인점수-계산-방식" class="nav-link" data-scroll-target="#요인점수-계산-방식"><span class="header-section-number">9.4.2</span> 요인점수 계산 방식</a></li>
  <li><a href="#요인점수의-특징" id="toc-요인점수의-특징" class="nav-link" data-scroll-target="#요인점수의-특징"><span class="header-section-number">9.4.3</span> 요인점수의 특징</a></li>
  <li><a href="#r-실습-예제-외식서비스-품질-요인점수-계산" id="toc-r-실습-예제-외식서비스-품질-요인점수-계산" class="nav-link" data-scroll-target="#r-실습-예제-외식서비스-품질-요인점수-계산"><span class="header-section-number">9.4.4</span> R 실습 예제: 외식서비스 품질 요인점수 계산</a></li>
  <li><a href="#요인점수-결과-시각화-및-분포-확인" id="toc-요인점수-결과-시각화-및-분포-확인" class="nav-link" data-scroll-target="#요인점수-결과-시각화-및-분포-확인"><span class="header-section-number">9.4.5</span> 요인점수 결과 시각화 및 분포 확인</a></li>
  <li><a href="#외식산업-예시로-본-요인점수-해석" id="toc-외식산업-예시로-본-요인점수-해석" class="nav-link" data-scroll-target="#외식산업-예시로-본-요인점수-해석"><span class="header-section-number">9.4.6</span> 외식산업 예시로 본 요인점수 해석</a></li>
  <li><a href="#요인점수의-해석과-활용" id="toc-요인점수의-해석과-활용" class="nav-link" data-scroll-target="#요인점수의-해석과-활용"><span class="header-section-number">9.4.7</span> 요인점수의 해석과 활용</a></li>
  <li><a href="#요인점수-활용-예-고객-군집분석" id="toc-요인점수-활용-예-고객-군집분석" class="nav-link" data-scroll-target="#요인점수-활용-예-고객-군집분석"><span class="header-section-number">9.4.8</span> 요인점수 활용 예: 고객 군집분석</a></li>
  <li><a href="#후속분석에서의-활용-예제" id="toc-후속분석에서의-활용-예제" class="nav-link" data-scroll-target="#후속분석에서의-활용-예제"><span class="header-section-number">9.4.9</span> 후속분석에서의 활용 예제</a></li>
  <li><a href="#요약-정리" id="toc-요약-정리" class="nav-link" data-scroll-target="#요약-정리"><span class="header-section-number">9.4.10</span> 요약 정리</a></li>
  </ul></li>
  <li><a href="#요인회전의-개념" id="toc-요인회전의-개념" class="nav-link" data-scroll-target="#요인회전의-개념"><span class="header-section-number">9.5</span> 요인회전의 개념</a>
  <ul class="collapse">
  <li><a href="#요인회전의-종류-직교-vs-비직교" id="toc-요인회전의-종류-직교-vs-비직교" class="nav-link" data-scroll-target="#요인회전의-종류-직교-vs-비직교"><span class="header-section-number">9.5.1</span> 요인회전의 종류: 직교 vs 비직교</a></li>
  <li><a href="#외식산업-예제-직교회전과-비직교회전-비교" id="toc-외식산업-예제-직교회전과-비직교회전-비교" class="nav-link" data-scroll-target="#외식산업-예제-직교회전과-비직교회전-비교"><span class="header-section-number">9.5.2</span> 외식산업 예제: 직교회전과 비직교회전 비교</a></li>
  <li><a href="#요인-간-상관-확인-비직교회전의-경우" id="toc-요인-간-상관-확인-비직교회전의-경우" class="nav-link" data-scroll-target="#요인-간-상관-확인-비직교회전의-경우"><span class="header-section-number">9.5.3</span> 요인 간 상관 확인 (비직교회전의 경우)</a></li>
  <li><a href="#실무-예시-고객-평가-데이터에서의-해석-차이" id="toc-실무-예시-고객-평가-데이터에서의-해석-차이" class="nav-link" data-scroll-target="#실무-예시-고객-평가-데이터에서의-해석-차이"><span class="header-section-number">9.5.4</span> 실무 예시: 고객 평가 데이터에서의 해석 차이</a></li>
  <li><a href="#요인회전의-수학적-원리와-시각적-이해" id="toc-요인회전의-수학적-원리와-시각적-이해" class="nav-link" data-scroll-target="#요인회전의-수학적-원리와-시각적-이해"><span class="header-section-number">9.5.5</span> 요인회전의 수학적 원리와 시각적 이해</a></li>
  <li><a href="#요인회전의-수학적-원리" id="toc-요인회전의-수학적-원리" class="nav-link" data-scroll-target="#요인회전의-수학적-원리"><span class="header-section-number">9.5.6</span> 요인회전의 수학적 원리</a></li>
  <li><a href="#직교회전-vs-비직교회전-수학적-예시" id="toc-직교회전-vs-비직교회전-수학적-예시" class="nav-link" data-scroll-target="#직교회전-vs-비직교회전-수학적-예시"><span class="header-section-number">9.5.7</span> 직교회전 vs 비직교회전 수학적 예시</a></li>
  <li><a href="#외식산업-예제-고객-평가요인-회전-결과-비교" id="toc-외식산업-예제-고객-평가요인-회전-결과-비교" class="nav-link" data-scroll-target="#외식산업-예제-고객-평가요인-회전-결과-비교"><span class="header-section-number">9.5.8</span> 외식산업 예제: 고객 평가요인 회전 결과 비교</a></li>
  <li><a href="#요인-간-관계-시각화-그래프-활용" id="toc-요인-간-관계-시각화-그래프-활용" class="nav-link" data-scroll-target="#요인-간-관계-시각화-그래프-활용"><span class="header-section-number">9.5.9</span> 요인 간 관계 시각화: 그래프 활용</a></li>
  <li><a href="#요인구조-시각화-요인적재량-플롯" id="toc-요인구조-시각화-요인적재량-플롯" class="nav-link" data-scroll-target="#요인구조-시각화-요인적재량-플롯"><span class="header-section-number">9.5.10</span> 요인구조 시각화: 요인적재량 플롯</a></li>
  <li><a href="#실무적-고려-회전-방식-선택-시-유의사항" id="toc-실무적-고려-회전-방식-선택-시-유의사항" class="nav-link" data-scroll-target="#실무적-고려-회전-방식-선택-시-유의사항"><span class="header-section-number">9.5.11</span> 실무적 고려: 회전 방식 선택 시 유의사항</a></li>
  </ul></li>
  <li><a href="#요인분석의-한계와-주의사항" id="toc-요인분석의-한계와-주의사항" class="nav-link" data-scroll-target="#요인분석의-한계와-주의사항"><span class="header-section-number">9.6</span> 요인분석의 한계와 주의사항</a>
  <ul class="collapse">
  <li><a href="#분산-손실-문제" id="toc-분산-손실-문제" class="nav-link" data-scroll-target="#분산-손실-문제"><span class="header-section-number">9.6.1</span> 분산 손실 문제</a></li>
  <li><a href="#해석-한계와-모호성" id="toc-해석-한계와-모호성" class="nav-link" data-scroll-target="#해석-한계와-모호성"><span class="header-section-number">9.6.2</span> 해석 한계와 모호성</a></li>
  <li><a href="#설문-품질에-대한-민감성" id="toc-설문-품질에-대한-민감성" class="nav-link" data-scroll-target="#설문-품질에-대한-민감성"><span class="header-section-number">9.6.3</span> 설문 품질에 대한 민감성</a></li>
  <li><a href="#회전-방식-선택의-중요성" id="toc-회전-방식-선택의-중요성" class="nav-link" data-scroll-target="#회전-방식-선택의-중요성"><span class="header-section-number">9.6.4</span> 회전 방식 선택의 중요성</a></li>
  <li><a href="#요인분석의-전제-조건" id="toc-요인분석의-전제-조건" class="nav-link" data-scroll-target="#요인분석의-전제-조건"><span class="header-section-number">9.6.5</span> 요인분석의 전제 조건</a></li>
  <li><a href="#한계-속에서도-요인분석의-가치" id="toc-한계-속에서도-요인분석의-가치" class="nav-link" data-scroll-target="#한계-속에서도-요인분석의-가치"><span class="header-section-number">9.6.6</span> 한계 속에서도 요인분석의 가치</a></li>
  </ul></li>
  <li><a href="#커피전문점-만족도-설문-실습-예제" id="toc-커피전문점-만족도-설문-실습-예제" class="nav-link" data-scroll-target="#커피전문점-만족도-설문-실습-예제"><span class="header-section-number">9.7</span> 커피전문점 만족도 설문 실습 예제</a>
  <ul class="collapse">
  <li><a href="#설문-문항-구성" id="toc-설문-문항-구성" class="nav-link" data-scroll-target="#설문-문항-구성"><span class="header-section-number">9.7.1</span> 설문 문항 구성</a></li>
  <li><a href="#데이터-불러오기-및-변수-분리" id="toc-데이터-불러오기-및-변수-분리" class="nav-link" data-scroll-target="#데이터-불러오기-및-변수-분리"><span class="header-section-number">9.7.2</span> 데이터 불러오기 및 변수 분리</a></li>
  <li><a href="#변수에-대한-확인" id="toc-변수에-대한-확인" class="nav-link" data-scroll-target="#변수에-대한-확인"><span class="header-section-number">9.7.3</span> 변수에 대한 확인</a></li>
  <li><a href="#요인분석-수행" id="toc-요인분석-수행" class="nav-link" data-scroll-target="#요인분석-수행"><span class="header-section-number">9.7.4</span> 요인분석 수행</a></li>
  <li><a href="#매개효과-검증-독립변수들---만족---재방문" id="toc-매개효과-검증-독립변수들---만족---재방문" class="nav-link" data-scroll-target="#매개효과-검증-독립변수들---만족---재방문"><span class="header-section-number">9.7.5</span> 매개효과 검증: 독립변수들 -&gt; 만족 -&gt; 재방문</a></li>
  <li><a href="#실습-마무리-요약" id="toc-실습-마무리-요약" class="nav-link" data-scroll-target="#실습-마무리-요약"><span class="header-section-number">9.7.6</span> 실습 마무리 요약</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">요인분석</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="요인분석의-개념" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="요인분석의-개념"><span class="header-section-number">9.1</span> 요인분석의 개념</h2>
<section id="변수는-많지만-구조는-단순할-수-있다" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="변수는-많지만-구조는-단순할-수-있다"><span class="header-section-number">9.1.1</span> 변수는 많지만 구조는 단순할 수 있다</h3>
<p>외식산업에서 고객 만족도 조사를 실시한다고 가정하자. 설문지에는 맛, 청결, 가격 만족도, 접근성, 분위기, 직원 친절도 등 다양한 항목이 들어간다. 처음 보면 각 문항이 독립적으로 보일 수 있지만 실제로는 서비스 만족, 제품 품질, 매장 환경처럼 <strong>더 큰 개념(요인)</strong>으로 묶일 수 있다.</p>
<p>이처럼 여러 변수들이 사실은 공통된 개념에 의해 함께 움직일 수 있다는 가정을 바탕으로, 변수 간 상관관계를 분석하여 그 <strong>공통된 구조를 찾아내는 것이 요인분석(factor analysis)</strong>의 목적이다.</p>
<p>요인분석은 단순한 차원축소가 아니라, <strong>숨겨진 구조를 발견하는 탐색도구</strong>에 가깝다.</p>
</section>
<section id="주성분분석과-요인분석은-어떻게-다른가" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="주성분분석과-요인분석은-어떻게-다른가"><span class="header-section-number">9.1.2</span> 주성분분석과 요인분석은 어떻게 다른가?</h3>
<p>요인분석은 흔히 주성분분석(PCA)과 혼동되지만, 통계적 철학과 수학적 가정이 다르다.</p>
<p>주성분분석은 단순히 데이터를 잘 요약할 수 있는 방향(축)을 찾는 방식이다. 이 방법은 변수 간의 <strong>전체 분산</strong>을 최대한 설명하는 축을 찾아 차원을 축소한다. 따라서 <strong>고유한 특성(노이즈 포함)을 제거하지 않는다</strong>.</p>
<p>반면 요인분석은 변수들이 공유하는 <strong>공통된 요인(common factor)</strong>만 설명하고, 각 변수 고유의 특성이나 오차는 <strong>인정하고 버리는 방식</strong>이다.</p>
<p>다시 말하면, 주성분분석은 전체 정보에 관심이 있고, 요인분석은 <strong>공통된 구조에만 관심이 있다</strong>.</p>
</section>
<section id="분산의-구조로-비교해보자" class="level3" data-number="9.1.3">
<h3 data-number="9.1.3" class="anchored" data-anchor-id="분산의-구조로-비교해보자"><span class="header-section-number">9.1.3</span> 분산의 구조로 비교해보자</h3>
<p>주성분분석에서는 전체 분산이 다음과 같이 구성된다.</p>
<blockquote class="blockquote">
<p><strong>Total Variance = Common Variance</strong></p>
</blockquote>
<p>이는 곧, 각 변수의 고유한 특성(Unique Variance)이 없다고 보는 것이다.</p>
<p>하지만 요인분석에서는 분산을 다음과 같이 분리한다.</p>
<blockquote class="blockquote">
<p><strong>Total Variance = Common Variance + Unique Variance</strong></p>
</blockquote>
<p>고유분산(unique variance)은 다시 <strong>특이한 요인(specific variance)</strong>과 <strong>오차(error)</strong>로 나뉜다. 이는 아래의 그림처럼 시각화할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 간단한 요인분석 분산 분해 개념 시각화</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">component =</span> <span class="fu">c</span>(<span class="st">"공통성"</span>, <span class="st">"고유성"</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">30</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> value, <span class="at">fill =</span> component)) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"요인분석의 분산 구성"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>이 그림은 전체 분산 중 약 70% 정도만 공통된 요인으로 설명되고, 나머지 30%는 각 변수 고유의 특성 또는 오차로 간주된다는 요인분석의 일반적 특징을 보여준다.</p>
</section>
<section id="외식산업-사례로-비교해보자" class="level3" data-number="9.1.4">
<h3 data-number="9.1.4" class="anchored" data-anchor-id="외식산업-사례로-비교해보자"><span class="header-section-number">9.1.4</span> 외식산업 사례로 비교해보자</h3>
<p>경기도 동탄의 B카페에서 고객에게 다음과 같은 항목으로 만족도 조사를 실시했다고 하자.</p>
<p><strong>-</strong> Q1: 매장의 분위기가 편안했다 <br> <strong>-</strong> Q2: 조명이 따뜻하고 아늑했다 <br> <strong>-</strong> Q3: 매장이 깨끗하게 유지되었다 <br> <strong>-</strong> Q4: 직원이 친절하게 응대했다 <br> <strong>-</strong> Q5: 주문이 정확하게 처리되었다 <br></p>
<p>학생들이 이 문항들을 각각 따로 분석한다면 너무 많은 변수를 다뤄야 하며, 해석도 어렵다. 하지만 이들 항목이 사실상 <strong>공통된 하나의 개념인 서비스 품질</strong>로 설명된다면, 이 하나의 요인을 사용해 분석을 단순화할 수 있다. 물론 여기서 주의할 점이 하나 있다. 보다 정확한 개념정의 및 구조화를 원한다면 학술논문을 주의 깊게 읽고 이를 파악하여 적용하여야 한다. 그러나, 단지 비즈니스적 분석을 목적으로 한다면 보다 자유롭게 해볼 수는 있다.</p>
<p>이처럼 요인분석은 <strong>다수의 문항을 묶어 숨겨진 구조를 찾고, 분석 가능성을 높이는 통계도구</strong>이다.</p>
</section>
<section id="수학적-표현으로-정리하면" class="level3" data-number="9.1.5">
<h3 data-number="9.1.5" class="anchored" data-anchor-id="수학적-표현으로-정리하면"><span class="header-section-number">9.1.5</span> 수학적 표현으로 정리하면</h3>
<p>요인분석에서는 각 관측변수를 다음과 같이 표현한다.</p>
<p><span class="math inline">\(X_1 = \lambda_1 \cdot F_1 + \epsilon_1\)</span> <br> <span class="math inline">\(X_2 = \lambda_2 \cdot F_2 + \epsilon_2\)</span> <br></p>
<p>여기서 <span class="math inline">\(\lambda\)</span>는 요인적재량(factor loading), <span class="math inline">\(F\)</span>는 공통요인, <span class="math inline">\(\epsilon\)</span>는 고유오차(측정오차 포함)이다.</p>
<p>즉, 각 변수는 공통요인에 일정한 가중치로 영향을 받으며, 고유한 요인도 일정 부분 작용한다고 본다. 이 점이 주성분분석과 다른 핵심이다.</p>
</section>
<section id="요인분석은-언제-사용하는가" class="level3" data-number="9.1.6">
<h3 data-number="9.1.6" class="anchored" data-anchor-id="요인분석은-언제-사용하는가"><span class="header-section-number">9.1.6</span> 요인분석은 언제 사용하는가?</h3>
<p><strong>1. 설문 문항이 많고 유사한 문항들이 있을 때</strong> <br> <strong>2. 숫자로 참조할 수 없는 ‘숨겨진 개념’(예: 서비스 만족도, 브랜드 이미지 등)을 해석하고자 할 때</strong> <br> <strong>3. 회귀분석 등에서 변수 수를 줄이고 다중공선성(multicollinearity) 문제를 피하고자 할 때</strong> <br></p>
<p>실제로 외식 마케팅이나 소비자 행동연구에서는 맛 만족도, 분위기 만족도, 재방문 의도 등을 요인으로 묶어서 구조방정식(SEM)이나 경로분석(Path Analysis)에 사용한다.</p>
</section>
<section id="정리하면" class="level3" data-number="9.1.7">
<h3 data-number="9.1.7" class="anchored" data-anchor-id="정리하면"><span class="header-section-number">9.1.7</span> 정리하면</h3>
<p>요인분석은 데이터를 단순화하지만 그 단순화는 무작위 축소가 아니라 <strong>이론적 구조와 통계적 상관관계를 기반으로 한 개념화 과정</strong>이다.</p>
<p>이제 다음 절에서는 <strong>요인을 어떻게 수학적으로 계산하고 추출하는지</strong>, 그리고 <strong>공통성(Communality)란 무엇인지</strong> 구체적으로 살펴본다. 요인분석의 수학적 기초는 주성분분석을 바탕으로 출발하기 때문에 PCA의 이해는 필수다.</p>
<p>여기까지 읽고 다음 질문을 고민해보자.</p>
<blockquote class="blockquote">
<p>“모든 변수의 고유성까지 포함해서 설명하는 게 더 좋은 거 아닐까? 왜 굳이 일부 분산(공통성)만 보려는 걸까?”</p>
</blockquote>
<p>이 의문이 요인분석의 본질을 이해하는 데 매우 중요하다.</p>
</section>
</section>
<section id="요인추출-방법" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="요인추출-방법"><span class="header-section-number">9.2</span> 요인추출 방법</h2>
<section id="왜-요인을-추출해야-하는가" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="왜-요인을-추출해야-하는가"><span class="header-section-number">9.2.1</span> 왜 요인을 추출해야 하는가?</h3>
<p>설문이나 관찰을 통해 수집한 수많은 변수들이 실제로는 몇 개의 공통된 구조에 의해 움직인다는 것을 파악하는 것이 요인분석의 핵심이다. 그런데 이 숨겨진 요인을 수학적으로 어떻게 “추출”할 수 있을까? 그때 사용하는 대표적인 방법이 바로 <strong>PAF(주축 요인 추출법, Principal Axis Factoring)</strong>이다.</p>
</section>
<section id="paf의-기본-아이디어" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="paf의-기본-아이디어"><span class="header-section-number">9.2.2</span> PAF의 기본 아이디어</h3>
<p>PAF는 상관관계 행렬을 바탕으로 요인을 추출한다. 하지만 일반적인 주성분분석(PCA)과는 달리, <strong>공통성(Communality)</strong>만을 고려한다는 점에서 다르다. 각 변수의 분산에서 공통적으로 설명되는 부분만 고려하고, 고유한 특성과 오차는 제거한다.</p>
<p>PAF의 분석 절차는 다음과 같은 흐름을 따른다.</p>
<p><strong>1. 먼저 변수들을 표준화한 후 상관관계 행렬을 구한다.</strong> <br> <strong>2. 이 상관관계 행렬의 대각 원소(분산)를 각 변수의 <span class="math inline">\(R^2\)</span> 값(설명력)으로 대체한다. 이것이 공통성의 초기 추정값이다.</strong> <br> <strong>3. 이 초기값을 가지고 요인적재량(factor loading)을 추정한 후, 다시 공통성을 재계산한다.</strong> <br> <strong>4. 공통성의 변화가 충분히 작아질 때까지 반복(iteration)한다.</strong> <br></p>
<p>즉, 초기 공통성 값으로 시작하여 반복 계산을 통해 점점 더 정밀하게 공통성을 추정하는 방식이다.</p>
</section>
<section id="공통성의-의미" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="공통성의-의미"><span class="header-section-number">9.2.3</span> 공통성의 의미</h3>
<p><strong>공통성(Communality)</strong>은 각 변수가 추출된 요인으로부터 얼마나 잘 설명되는지를 나타낸다. 수학적으로는 변수와 요인의 상관계수의 <strong>제곱합</strong>으로 계산된다. 공통성이 1에 가까울수록 해당 변수는 요인으로 잘 설명된다는 뜻이다. 반대로 공통성이 0에 가까우면 그 변수는 요인으로 설명되지 않는다는 의미다.</p>
<p>예를 들어, 외식 매장에 대한 설문에서 ‘직원의 친절도’, ‘주문 정확성’, ’매장 청결도’가 하나의 요인(서비스 품질)으로 묶일 때, 이 변수들의 공통성은 0.8 이상이어야 해석력이 높다.</p>
</section>
<section id="외식산업-예제-커피전문점-만족도-요인-분석" class="level3" data-number="9.2.4">
<h3 data-number="9.2.4" class="anchored" data-anchor-id="외식산업-예제-커피전문점-만족도-요인-분석"><span class="header-section-number">9.2.4</span> 외식산업 예제: 커피전문점 만족도 요인 분석</h3>
<p>한 커피전문점에서 다음과 같은 문항으로 고객만족도 설문을 실시했다고 하자.</p>
<table class="table-striped table-hover table">
<thead>
<tr class="header">
<th style="text-align: center;">문항</th>
<th style="text-align: left;">내용</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Q1</td>
<td style="text-align: left;">직원들이 항상 친절하게 응대했다</td>
</tr>
<tr class="even">
<td style="text-align: center;">Q2</td>
<td style="text-align: left;">요청 사항에 대해 신속히 반응했다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Q3</td>
<td style="text-align: left;">종업원의 말투와 태도가 예의 바르다고 느꼈다</td>
</tr>
<tr class="even">
<td style="text-align: center;">Q4</td>
<td style="text-align: left;">매장이 청결하게 관리되고 있었다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Q5</td>
<td style="text-align: left;">매장의 조명과 분위기가 쾌적했다</td>
</tr>
<tr class="even">
<td style="text-align: center;">Q6</td>
<td style="text-align: left;">매장 내 소음이 적절하고 편안했다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Q7</td>
<td style="text-align: left;">음식의 맛이 만족스러웠다</td>
</tr>
<tr class="even">
<td style="text-align: center;">Q8</td>
<td style="text-align: left;">음식이 신선하게 느껴졌다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Q9</td>
<td style="text-align: left;">음식이 적절한 온도로 제공되었다</td>
</tr>
</tbody>
</table>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 30%">
<col style="width: 40%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: center;">설명</th>
<th style="text-align: center;">문항 예시</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>서비스 친절 요인</strong></td>
<td style="text-align: center;">종업원의 친절, 태도, 응대 품질</td>
<td style="text-align: center;">Q1, Q2, Q3</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>매장 환경 요인</strong></td>
<td style="text-align: center;">청결도, 분위기, 조명/소음 등</td>
<td style="text-align: center;">Q4, Q5, Q6</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>음식 품질 요인</strong></td>
<td style="text-align: center;">맛, 신선도, 온도 유지 등</td>
<td style="text-align: center;">Q7, Q8, Q9</td>
</tr>
</tbody>
</table>
</section>
<section id="r에서-paf-실행-예제" class="level3" data-number="9.2.5">
<h3 data-number="9.2.5" class="anchored" data-anchor-id="r에서-paf-실행-예제"><span class="header-section-number">9.2.5</span> R에서 PAF 실행 예제</h3>
<p>다음은 위의 설문 문항을 시뮬레이션한 데이터를 사용하여 R에서 PAF를 수행하는 예시다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 필요한 패키지 로딩</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GPArotation)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 설문 대상 수</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 요인에 해당하는 잠재 변수 생성</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>factor1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">3.5</span>, <span class="at">sd =</span> <span class="fl">0.7</span>)  <span class="co"># 친절</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>factor2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">3.0</span>, <span class="at">sd =</span> <span class="fl">0.7</span>)  <span class="co"># 환경</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>factor3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">3.2</span>, <span class="at">sd =</span> <span class="fl">0.7</span>)  <span class="co"># 음식</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 문항에 대해 요인 점수 + 노이즈 (Likert 1~5 범위로 클리핑)</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>Q2 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>Q4 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>Q5 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>Q6 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>Q7 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>Q8 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>Q9 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(factor3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.4</span>)), <span class="dv">1</span>), <span class="dv">5</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터프레임 생성</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Q1, Q2, Q3, Q4, Q5, Q6, Q7, Q8, Q9)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 확인</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Q1              Q2             Q3             Q4             Q5       
 Min.   :2.000   Min.   :2.00   Min.   :2.00   Min.   :1.00   Min.   :1.000  
 1st Qu.:3.000   1st Qu.:3.00   1st Qu.:3.00   1st Qu.:2.75   1st Qu.:3.000  
 Median :3.000   Median :4.00   Median :3.00   Median :3.00   Median :3.000  
 Mean   :3.495   Mean   :3.51   Mean   :3.52   Mean   :3.01   Mean   :3.055  
 3rd Qu.:4.000   3rd Qu.:4.00   3rd Qu.:4.00   3rd Qu.:4.00   3rd Qu.:4.000  
 Max.   :5.000   Max.   :5.00   Max.   :5.00   Max.   :5.00   Max.   :5.000  
       Q6             Q7              Q8              Q9       
 Min.   :1.00   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.00   1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000  
 Median :3.00   Median :3.000   Median :3.000   Median :3.000  
 Mean   :3.05   Mean   :3.255   Mean   :3.145   Mean   :3.215  
 3rd Qu.:4.00   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :5.00   Max.   :5.000   Max.   :5.000   Max.   :5.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Q1            Q2           Q3           Q4          Q5          Q6
Q1  1.00000000  0.6291281430  0.608724019  0.036238918  0.03590520  0.07948124
Q2  0.62912814  1.0000000000  0.669141541  0.047738708  0.04762638  0.03664143
Q3  0.60872402  0.6691415406  1.000000000 -0.054588685 -0.04972186 -0.02375514
Q4  0.03623892  0.0477387082 -0.054588685  1.000000000  0.69221857  0.65406880
Q5  0.03590520  0.0476263798 -0.049721856  0.692218568  1.00000000  0.65062233
Q6  0.07948124  0.0366414263 -0.023755141  0.654068798  0.65062233  1.00000000
Q7 -0.01623804 -0.0000683904  0.010048198  0.003024925  0.05513139 -0.01046192
Q8 -0.02566752 -0.0129485813  0.006606757  0.011165769  0.02422931 -0.06032680
Q9 -0.01766791 -0.0141102287  0.062707838 -0.042433718 -0.01700837 -0.13817515
              Q7           Q8          Q9
Q1 -0.0162380449 -0.025667522 -0.01766791
Q2 -0.0000683904 -0.012948581 -0.01411023
Q3  0.0100481981  0.006606757  0.06270784
Q4  0.0030249248  0.011165769 -0.04243372
Q5  0.0551313882  0.024229313 -0.01700837
Q6 -0.0104619164 -0.060326799 -0.13817515
Q7  1.0000000000  0.689535917  0.66673284
Q8  0.6895359174  1.000000000  0.69635746
Q9  0.6667328410  0.696357458  1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(data, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  3  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 회전 전 요인분석 (PAF, 요인 수 3개)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fa_pa_unrotated <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 회전 후 요인분석 (Varimax 회전)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>fa_pa_rotated <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 결과 비교 출력</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_pa_unrotated, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  pa
Call: fa(r = data, nfactors = 3, rotate = "none", fm = "pa")
Standardized loadings (pattern matrix) based upon correlation matrix
   item    PA1   PA2    PA3    h2    u2  com
Q9    9  0.694 0.449 -0.067 0.688 0.312 1.74
Q8    8  0.671 0.499 -0.125 0.715 0.285 1.93
Q7    7  0.625 0.503 -0.123 0.658 0.342 2.00
Q6    6 -0.526 0.512 -0.300 0.628 0.372 2.58
Q5    5 -0.459 0.596 -0.353 0.691 0.309 2.56
Q4    4 -0.488 0.574 -0.350 0.689 0.311 2.64
Q3    3 -0.068 0.310  0.750 0.664 0.336 1.35
Q2    2 -0.166 0.367  0.724 0.686 0.314 1.60
Q1    1 -0.170 0.334  0.660 0.576 0.424 1.64

                        PA1   PA2   PA3
SS loadings           2.109 1.993 1.894
Proportion Var        0.234 0.221 0.210
Cumulative Var        0.234 0.456 0.666
Proportion Explained  0.352 0.332 0.316
Cumulative Proportion 0.352 0.684 1.000

Mean item complexity =  2
Test of the hypothesis that 3 factors are sufficient.

df null model =  36  with the objective function =  4.102 with Chi Square =  800.634
df of  the model are 12  and the objective function was  0.04 

The root mean square of the residuals (RMSR) is  0.011 
The df corrected root mean square of the residuals is  0.019 

The harmonic n.obs is  200 with the empirical chi square  1.721  with prob &lt;  1 
The total n.obs was  200  with Likelihood Chi Square =  7.687  with prob &lt;  0.809 

Tucker Lewis Index of factoring reliability =  1.0171
RMSEA index =  0  and the 90 % confidence intervals are  0 0.046
BIC =  -55.893
Fit based upon off diagonal values = 0.999
Measures of factor score adequacy             
                                                    PA1   PA2   PA3
Correlation of (regression) scores with factors   0.932 0.927 0.920
Multiple R square of scores with factors          0.869 0.860 0.847
Minimum correlation of possible factor scores     0.738 0.720 0.693</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_pa_rotated, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  pa
Call: fa(r = data, nfactors = 3, rotate = "varimax", fm = "pa")
Standardized loadings (pattern matrix) based upon correlation matrix
   item    PA1    PA2    PA3    h2    u2  com
Q8    8  0.846  0.002 -0.013 0.715 0.285 1.00
Q9    9  0.827 -0.070  0.014 0.688 0.312 1.01
Q7    7  0.811  0.031 -0.003 0.658 0.342 1.00
Q4    4  0.001  0.830  0.003 0.689 0.311 1.00
Q5    5  0.037  0.830  0.005 0.691 0.309 1.00
Q6    6 -0.073  0.789  0.028 0.628 0.372 1.02
Q2    2 -0.009  0.043  0.827 0.686 0.314 1.01
Q3    3  0.032 -0.065  0.812 0.664 0.336 1.02
Q1    1 -0.023  0.051  0.757 0.576 0.424 1.01

                        PA1   PA2   PA3
SS loadings           2.064 2.015 1.917
Proportion Var        0.229 0.224 0.213
Cumulative Var        0.229 0.453 0.666
Proportion Explained  0.344 0.336 0.320
Cumulative Proportion 0.344 0.680 1.000

Mean item complexity =  1
Test of the hypothesis that 3 factors are sufficient.

df null model =  36  with the objective function =  4.102 with Chi Square =  800.634
df of  the model are 12  and the objective function was  0.04 

The root mean square of the residuals (RMSR) is  0.011 
The df corrected root mean square of the residuals is  0.019 

The harmonic n.obs is  200 with the empirical chi square  1.721  with prob &lt;  1 
The total n.obs was  200  with Likelihood Chi Square =  7.687  with prob &lt;  0.809 

Tucker Lewis Index of factoring reliability =  1.0171
RMSEA index =  0  and the 90 % confidence intervals are  0 0.046
BIC =  -55.893
Fit based upon off diagonal values = 0.999
Measures of factor score adequacy             
                                                    PA1   PA2   PA3
Correlation of (regression) scores with factors   0.932 0.928 0.920
Multiple R square of scores with factors          0.869 0.860 0.846
Minimum correlation of possible factor scores     0.738 0.721 0.692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 요인적재량 시각화 (회전 전후 비교)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>loadings_unrot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fa_pa_unrotated<span class="sc">$</span>loadings))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>loadings_rot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fa_pa_rotated<span class="sc">$</span>loadings))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>loadings_unrot<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loadings_unrot)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>loadings_rot<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loadings_rot)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>loadings_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  loadings_unrot <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Rotation =</span> <span class="st">"Unrotated"</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  loadings_rot <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Rotation =</span> <span class="st">"Varimax"</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PA1, PA2), <span class="at">names_to =</span> <span class="st">"Factor"</span>, <span class="at">values_to =</span> <span class="st">"Loading"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(loadings_long, <span class="fu">aes</span>(<span class="at">x =</span> Variable, <span class="at">y =</span> Loading, <span class="at">fill =</span> Factor)) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Rotation) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"요인적재량 비교: 회전 전 vs 회전 후"</span>, <span class="at">y =</span> <span class="st">"적재량"</span>, <span class="at">x =</span> <span class="st">"문항"</span>) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>위에서 1차적으로 적정요인의 개수를 <strong>Scree Plot</strong>을 이용해서 확인하였다. <strong>eigen value가 1 이상인 요인은 3개</strong>로 확인되어 적정 요인수는 3개임을 알 수 있다. 단순히 결과가 그렇기 때문이 아니라, 이는 우리가 이 분석을 하기 전에 이미 이러한 구조 즉, <strong>3개의 요인이 나오도록 설문을 구성</strong>했기 때문에 이렇게 된 것이다. 결론적으로 우리가 구성한 설문이 <strong>우리의 계획대로 3개의 요인 즉 개념으로 잘 구성</strong>되었다는 것이 1차적으로 Scree Plot을 통해 검증된 것이다.</p>
<p>다음은 무회전 vs.&nbsp;varimax 회전 요인분석의 결과에 대한 비교이다.</p>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 30%">
<col style="width: 35%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">항목</th>
<th style="text-align: left;">무회전 (None)</th>
<th style="text-align: left;">Varimax 회전</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>SS loadings <br> (합산 요인적재 제곱합)</strong></td>
<td style="text-align: left;">2.109, 1.993, 1.894</td>
<td style="text-align: left;">2.064, 2.015, 1.917</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Proportion of Variance <br> (고유분산 설명비율)</strong></td>
<td style="text-align: left;">0.234, 0.221, 0.210</td>
<td style="text-align: left;">0.229, 0.224, 0.213</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Cumulative Variance <br> (누적 설명력)</strong></td>
<td style="text-align: left;">66.6%</td>
<td style="text-align: left;">66.6% (동일)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Tucker Lewis Index (TLI)</strong></td>
<td style="text-align: left;">1.0171</td>
<td style="text-align: left;">1.0171</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>RMSEA</strong></td>
<td style="text-align: left;">0 (90% CI: 0 ~ 0.046)</td>
<td style="text-align: left;">0 (동일)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>RMSR</strong></td>
<td style="text-align: left;">0.011</td>
<td style="text-align: left;">0.011 (동일)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Factor Score Adequacy <br> (요인점수 적합도)</strong></td>
<td style="text-align: left;">PA1–3: 0.869, 0.860, 0.847 (R²)</td>
<td style="text-align: left;">거의 동일 (변동 없음)</td>
</tr>
</tbody>
</table>
<p>우선 무회전 (rotate = “none”) 요인분석 결과에 대해 살펴보자. 무회전 요인분석의 경우 적재량이 세 요인에 고루 분산되어 있음을 알 수 있다. 그러나, 대부분의 문항이 여러 요인에 중복 적재되어 어느 문항이 어느 요인에 관련된 것인지 해석이 모호하다. 예를 들어, 문항 Q3이 PA1 0.45, PA2 0.39 등으로 적재되면 해당 문항이 어떤 요인을 대표하는지 불분명하다. 또 다른 특징은 <span class="math inline">\(\text{Mean Item Complexity} = 2\)</span>라는 것인데, 이는 각 문항이 평균적으로 두 개 요인에 의미 있는 적재를 보였다는 의미이다. 따라서, 이런 경우 해석 가능성이 낮고, 설문지 항목을 분류하거나 명확한 요인명을 붙이기 어렵다.</p>
<p>이러한 문제를 해결하기 위해 요인분석에서는 rotation을 일반적으로 사용한다. 뒤에서 자세하게 다루겠지만, rotation이란 축을 회전시킴으로써 각 설문문항이 축에 대응되도록 하는 것이다. 여기서는 Varimax 회전 (rotate = “varimax”)을 사용한 결과를 살펴보겠다. 각 문항이 하나의 요인에 명확하게 적재되어 있다. 이로 인해, 문항과 요인 간 일대일 대응 관계가 명확해지고, 해석이 쉬워졌다. 또한, <span class="math inline">\(\text{Mean Item Complexity} = 1\)</span>로 각 문항이 거의 하나의 요인에만 적재되어 있다는 것이 특징이다. 따라서, 요인명의 명명(factor naming)이 명확하고, 실제 구성 개념과의 대응이 쉽다.</p>
<p>더 자세한 해석은 다음 절에서 공부하도록 하자.</p>
</section>
<section id="spss와-r의-차이점은" class="level3" data-number="9.2.6">
<h3 data-number="9.2.6" class="anchored" data-anchor-id="spss와-r의-차이점은"><span class="header-section-number">9.2.6</span> SPSS와 R의 차이점은?</h3>
<p>SPSS에서는 기본적으로 공통성의 초기값을 변수별 다중회귀분석의 <span class="math inline">\(R^2\)</span>로 설정하고 반복(iteration)을 통해 재추정한다. SPSS는 사용자가 iteration 종료 조건을 수정하지 않는 한, 기본적으로 25회까지만 반복하고 멈춘다.</p>
<p>반면 R의 <code>psych::fa()</code> 함수에서는 iteration 종료 기준을 <code>epsilon</code> 값(예: 0.001 미만)으로 제어하며, 반복 횟수는 <code>max.iter</code> 인자를 통해 조정할 수 있다. 또한 R은 다양한 요인추출법(<code>fm = "ml"</code>, <code>"minres"</code>, <code>"uls"</code>, <code>"pa"</code>)을 지원하며, 공통성 초기 추정값도 사용자가 직접 설정할 수 있다.</p>
<p>따라서 <strong>SPSS는 사용이 간편하나 유연성이 낮고</strong>, <strong>R은 복잡하지만 고급 설정이 가능하다</strong>는 특징이 있다.</p>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 17%">
<col style="width: 43%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">항목</th>
<th style="text-align: left;">R (psych 패키지 중심)</th>
<th style="text-align: left;">SPSS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>주요 알고리즘</strong></td>
<td style="text-align: left;"><code>fa()</code> 함수에서 <code>fm=</code> 인자로 선택<br> - <code>pa</code>: Principal Axis Factoring<br> - <code>ml</code>: Maximum Likelihood<br> - <code>minres</code>: Minimum Residual (기본값)<br> - <code>wls</code>: Weighted Least Squares<br> - <code>gls</code>: Generalized LS<br> - <code>ols</code>, <code>uls</code>, <code>alpha</code>, <code>beta</code> 등</td>
<td style="text-align: left;">- Principal Axis Factoring<br> - Maximum Likelihood<br> - Alpha Factoring<br> - Unweighted Least Squares<br> - Image Factoring</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>회전 방식</strong></td>
<td style="text-align: left;">- <code>rotate=</code> 인자 사용<br> - <code>none</code>, <code>varimax</code>, <code>promax</code>, <code>oblimin</code>, <code>quartimin</code> 등 다수 지원</td>
<td style="text-align: left;">- Orthogonal (Varimax)<br> - Oblique (Promax, Oblimin)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>결과 요약</strong></td>
<td style="text-align: left;">- 고유값, 공통성(h2), 고유성(u2), 적재량<br> - RMSEA, RMSR, TLI, BIC 등</td>
<td style="text-align: left;">- Eigenvalue, Communality<br> - KMO/Bartlett test<br> - Total Variance Explained</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>표준화 여부</strong></td>
<td style="text-align: left;">사용자가 명시해야 함 (<code>cor=TRUE</code> 등)</td>
<td style="text-align: left;">자동 표준화 처리</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>시각화</strong></td>
<td style="text-align: left;">별도 시각화 패키지 필요 (<code>fa.diagram</code>, <code>psych::plot</code>)</td>
<td style="text-align: left;">기본 GUI에 Scree Plot, Component Plot 포함</td>
</tr>
</tbody>
</table>
<p>간혹 데이터가 큰 경우 SPSS와 R에서 약간씩 다른 요인분석 결과가 나오기도 하는데 원인은 여러가지가 있지만, 대체로 다음의 것들이 주요한 원인이다 .</p>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 28%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">원인</th>
<th style="text-align: left;">설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>표준화 여부</strong></td>
<td style="text-align: left;">R에서는 raw data일 경우 표준화 생략되기도 하며 SPSS는 자동 표준화</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>결측치 처리</strong></td>
<td style="text-align: left;">R은 명시적으로 처리해야 하며, SPSS는 pairwise 또는 listwise로 처리함</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>회전 알고리즘<br>구현 방식 차이</strong></td>
<td style="text-align: left;">동일 명칭이더라도 구현 방식과 정밀도에서 차이 발생</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>추출 방식의<br>수치적 최적화 방식</strong></td>
<td style="text-align: left;">특히 <code>ml</code>과 같이 수치최적화를 요하는 방식에서는 초기값 설정에 따라 수렴 결과가 달라짐</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>기본 옵션 차이</strong></td>
<td style="text-align: left;">SPSS는 고정 옵션이 많고 사용자가 세밀하게 설정하기 어렵지만, R은 매우 유연한 대신 숙련도 필요</td>
</tr>
</tbody>
</table>
</section>
<section id="마무리하며" class="level3" data-number="9.2.7">
<h3 data-number="9.2.7" class="anchored" data-anchor-id="마무리하며"><span class="header-section-number">9.2.7</span> 마무리하며</h3>
<p>PAF는 요인분석에서 가장 보편적으로 사용되는 요인추출 기법이다. 공통성의 반복 추정 과정을 통해 보다 정확하게 요인을 정의하고, 각 변수와 요인의 관계를 수학적으로 모델링할 수 있다.</p>
<p>PAF의 핵심인 공통성의 개념을 반드시 이해하고 있어야 하며, 반복(iteration)의 의미와 종료 기준이 어떤 방식으로 결정되는지도 숙지해야 한다. 특히 실무에서는 <strong>공통성이 0.5 이상인 변수만 해석 대상으로 삼는다</strong>는 실무적 기준도 기억해두면 좋다.</p>
<p>다음 절에서는 이 요인들을 어떻게 시각적으로 단순화하고 해석력을 높이는지, 즉 <strong>요인회전(Factor Rotation)</strong>에 대해 다룬다.</p>
</section>
</section>
<section id="요인분석-결과-해석" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="요인분석-결과-해석"><span class="header-section-number">9.3</span> 요인분석 결과 해석</h2>
<p>외식서비스 만족도 조사를 통해 수집한 문항 데이터를 바탕으로 요인분석을 실시하였다. 설문문항은 총 9개이며, 각각 친절, 환경, 음식이라는 세 가지 요인을 측정하도록 설계되었다. 분석 목적은 이들 문항이 실제로 어떤 요인으로 묶이는지 파악하고, 각각의 요인이 데이터 전체에서 어떤 역할을 하는지를 해석하는 데 있다.</p>
<table class="table-striped table-hover table">
<thead>
<tr class="header">
<th style="text-align: center;">문항</th>
<th style="text-align: left;">내용</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Q1</td>
<td style="text-align: left;">직원들이 항상 친절하게 응대했다</td>
</tr>
<tr class="even">
<td style="text-align: center;">Q2</td>
<td style="text-align: left;">요청 사항에 대해 신속히 반응했다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Q3</td>
<td style="text-align: left;">종업원의 말투와 태도가 예의 바르다고 느꼈다</td>
</tr>
<tr class="even">
<td style="text-align: center;">Q4</td>
<td style="text-align: left;">매장이 청결하게 관리되고 있었다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Q5</td>
<td style="text-align: left;">매장의 조명과 분위기가 쾌적했다</td>
</tr>
<tr class="even">
<td style="text-align: center;">Q6</td>
<td style="text-align: left;">매장 내 소음이 적절하고 편안했다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Q7</td>
<td style="text-align: left;">음식의 맛이 만족스러웠다</td>
</tr>
<tr class="even">
<td style="text-align: center;">Q8</td>
<td style="text-align: left;">음식이 신선하게 느껴졌다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Q9</td>
<td style="text-align: left;">음식이 적절한 온도로 제공되었다</td>
</tr>
</tbody>
</table>
<p>요인분석 결과 해석을 위해 다음의 핵심 지표들을 이해해야 한다: <strong>요인적재량(Factor loading)</strong>, <strong>공통성(Communality)</strong>, <strong>고유값(Eigen value)</strong>, <strong>설명된 총분산(Total Variance Explained)</strong> 등이다.</p>
<p>다음은 앞서 분석한 결과에 대해 설명을 붙인 것이다.</p>
<pre class="text"><code># 무회전 요인분석 결과 (Unrotated Factor Analysis)
Factor Analysis using method = pa  # 요인추출 알고리즘: Principal Axis Factoring (PAF)
Call: fa(r = data, nfactors = 3, rotate = 'none', fm = 'pa') # 요인 3개 지정, 회전 없음
Standardized loadings (pattern matrix) based upon correlation matrix

                        PA1   PA2   PA3
SS loadings           2.109 1.993 1.894  # 각 요인이 설명하는 고유값의 합 (Eigen value)
Proportion Var        0.234 0.221 0.210  # 각 요인이 설명하는 분산 비율
Cumulative Var        0.234 0.456 0.666  # 누적 설명력: 요인 3개로 전체 분산의 66.6% 설명
Proportion Explained  0.352 0.332 0.316  # 전체 설명된 분산 중 각 요인이 기여한 비율
Cumulative Proportion 0.352 0.684 1.000  # 누적 기여도 (전체 비율로 100% 맞춤)

Mean item complexity =  2  # 각 문항이 평균적으로 약 2개의 요인에 적재됨
Test of the hypothesis that 3 factors are sufficient.

df null model =  36  with the objective function =  4.102 
with Chi Square =  800.634   # Null 모형 (요인 없음)에서의 적합도
df of  the model are 12  and the objective function was  0.04  
                                # 요인모형의 자유도 및 목적함수 값

The root mean square of the residuals (RMSR) is  0.011 # 잔차 제곱평균근, 낮을수록 좋음
The df corrected root mean square of the residuals is  0.019 # 자유도 보정된 RMSR

The harmonic n.obs is  200 
with the empirical chi square  1.721  with prob &lt;  1 
                                # 경험적 카이제곱 값과 p값 (적합도 우수)
The total n.obs was  200  
with Likelihood Chi Square =  7.687  with prob &lt;  0.809      
                                # 우도기반 카이제곱 검정 결과 (모형 적합함)

Tucker Lewis Index of factoring reliability =  1.0171 # TLI &gt; 0.9 → 매우 양호한 적합도
RMSEA index =  0                            # RMSEA = 0 → 완전 적합
90 % confidence intervals are  0 0.046      # 신뢰구간도 0~0.05 → 완전 적합 범위
BIC =  -55.893                              # Bayesian Information Criterion (낮을수록 좋음)
Fit based upon off diagonal values = 0.999  # 요인 모형이 상관행렬의 비대각 요소를 잘 설명

Measures of factor score adequacy           # 요인 점수의 정확도 평가
                                                    PA1   PA2   PA3
Correlation of (regression) scores with factors   0.932 0.927 0.920   
                                               # 요인 점수와 진짜 요인의 상관 (높을수록 좋음)
Multiple R square of scores with factors          0.869 0.860 0.847   
                                               # 결정계수 (요인 점수의 설명력)
Minimum correlation of possible factor scores     0.738 0.720 0.693   
                                               # 가능한 최소 상관 (음수이면 해석 주의)


# 문항별 요인 적재값 및 해석 (무회전 요인분석 기준)

item   PA1     PA2     PA3     h2        u2        com     # 해석
Q9     0.694   0.449  -0.067   0.6884   0.3116    1.7356    # 요인1과 2에 교차 적재
Q8     0.671   0.499  -0.125   0.7153   0.2847    1.9292    # 요인1과 2에 교차 적재
Q7     0.625   0.503  -0.123   0.6584   0.3416    2.0009    # 요인1과 2에 교차 적재
Q6    -0.526   0.512  -0.300   0.6285   0.3715    2.5777    # 요인1과 2에 교차 적재
Q5    -0.459   0.596  -0.353   0.6906   0.3094    2.5629    # 요인1에 2,3에 교차적재
Q4    -0.488   0.574  -0.350   0.6893   0.3107    2.6426    # Q5와 유사 - 해석 주의
Q3    -0.068   0.310   0.750   0.6639   0.3361    1.3510    # 요인3 단일요인 문항
Q2    -0.166   0.367   0.724   0.6860   0.3140    1.6037    # 요인3 중심
Q1    -0.170   0.334   0.660   0.5760   0.4240    1.6368    # 요인3에 주로 적재</code></pre>
<pre class="text"><code># Varimax 회전 요인분석 결과

Factor Analysis using method = pa  # 요인추출 방식: 주축요인법(principal axis factoring)
Call: fa(r = data, nfactors = 3, rotate = 'varimax', fm = 'pa')
                                   # 요인 3개, Varimax 회전 적용, 추출방법은 'pa'

Standardized loadings (pattern matrix) based upon correlation matrix

                        PA1   PA2   PA3
SS loadings           2.064 2.015 1.917  # 각 요인이 설명하는 고유값 (eigen value)
Proportion Var        0.229 0.224 0.213  # 각 요인이 설명하는 전체 분산의 비율
Cumulative Var        0.229 0.453 0.666  # 누적 설명력: 세 요인이 총 66.6%의 분산 설명
Proportion Explained  0.344 0.336 0.320  # 총 공통성 중 각 요인이 설명하는 비율
Cumulative Proportion 0.344 0.680 1.000  # 총 공통성에 대한 누적 설명 비율

Mean item complexity =  1  # 평균 복잡도: 각 문항이 주로 하나의 요인에만 적재 (이상적)

Test of the hypothesis that 3 factors are sufficient.

df null model =  36  with the objective function =  4.102 with Chi Square =  800.634
                                          # null 모델 적합도 (상관 없음 가정)
df of  the model are 12  and the objective function was  0.04
                                          # 3요인 모델의 적합도, 매우 작음 → 좋은 적합

The root mean square of the residuals (RMSR) is  0.011
                                          # 잔차 제곱 평균: 0.05 미만은 매우 양호
The df corrected root mean square of the residuals is  0.019
                                          # 자유도 보정 잔차 제곱 평균

The harmonic n.obs is  200 with the empirical chi square  1.721  with prob &lt;  1
                                          # 관측치 200명 기준 경험적 적합도 매우 우수
The total n.obs was  200  with Likelihood Chi Square =  7.687  with prob &lt;  0.809
                                          # 우도 기반 카이제곱도 비유의미 → 적합도 양호

Tucker Lewis Index of factoring reliability =  1.0171
                                          # TLI &gt; 0.95 이면 매우 적합, 1 초과는 과적합 가능성
RMSEA index =  0  and the 90 % confidence intervals are  0 0.046
                                          # RMSEA = 0 → 완벽한 적합, 상한도 0.05 미만으로 우수
BIC =  -55.893                            # 모형 선택 지표, 음수는 적합도 우수
Fit based upon off diagonal values = 0.999  # 비대각선 상의 적합도: 1에 가까울수록 이상적

Measures of factor score adequacy

                                                    PA1   PA2   PA3
Correlation of (regression) scores with factors   0.932 0.928 0.920
                                            # 추정된 요인 점수와 실제 요인 간 상관: 0.9 이상으로 매우 높음
Multiple R square of scores with factors          0.869 0.860 0.846
                                            # 요인 점수가 실제 요인을 설명하는 결정계수 (설명력)
Minimum correlation of possible factor scores     0.738 0.721 0.692
                                            # 가능한 최소 상관도: 요인점수의 신뢰도 수준 반영


# Varimax 회전 요인분석 결과 해석

item   PA1     PA2     PA3     h2        u2        com     # 해석
Q8     0.846   0.002  -0.013   0.7153   0.2847    1.0005    # 요인1에 강하게 적재
Q9     0.827  -0.070   0.014   0.6884   0.3116    1.0149    # 요인1 중심, 단일 적재 구조
Q7     0.811   0.031  -0.003   0.6584   0.3416    1.0029    # 요인1 전용 문항
Q4     0.001   0.830   0.003   0.6893   0.3107    1.0000    # 요인2에 명확하게 적재
Q5     0.037   0.830   0.005   0.6906   0.3094    1.0041    # 요인2에만 적재됨
Q6    -0.073   0.789   0.028   0.6285   0.3715    1.0196    # 요인2 전용 문항.
Q2    -0.009   0.043   0.827   0.6860   0.3140    1.0056    # 요인3에 강하게 적재
Q3     0.032  -0.065   0.812   0.6639   0.3361    1.0157    # 요인3에 적재
Q1    -0.023   0.051   0.757   0.5760   0.4240    1.0108    # 요인3 중심</code></pre>
<section id="요인적재량factor-loading-변수와-요인-간의-관계" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="요인적재량factor-loading-변수와-요인-간의-관계"><span class="header-section-number">9.3.1</span> 요인적재량(Factor loading): 변수와 요인 간의 관계</h3>
<p>요인적재량은 각 문항이 특정 요인에 얼마나 밀접하게 연관되어 있는지를 나타낸다. 값이 클수록 해당 요인이 해당 문항을 잘 설명하고 있다는 뜻이다. 일반적으로 0.4 이상을 의미 있는 적재값으로 본다.</p>
<p>예를 들어, 회전 후 분석결과에서 Q8의 PA1 적재량은 0.846로 매우 높으며, 이는 Q8이 요인1(친절)에 강하게 관련되어 있음을 보여준다. 반대로 PA2와 PA3의 적재량은 0.002, -0.013로 매우 낮아 이 문항이 다른 요인들과는 관련이 거의 없음을 의미한다.</p>
</section>
<section id="공통성communality-요인들이-설명하는-변수의-분산-비율" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="공통성communality-요인들이-설명하는-변수의-분산-비율"><span class="header-section-number">9.3.2</span> 공통성(Communality): 요인들이 설명하는 변수의 분산 비율</h3>
<p>공통성은 특정 문항의 분산 중에서 요인들이 함께 설명해주는 부분을 의미한다. 값이 0.7 이상이면 해당 문항이 요인구조 내에서 잘 설명된다고 판단할 수 있다.</p>
<p>예를 들어 Q8의 공통성(h2 값)은 0.7153이며, 이는 전체 분산의 71.5%가 요인들에 의해 설명된다는 뜻이다. 반대로 Q1의 공통성은 0.576으로 상대적으로 낮아, 해당 문항이 요인 구조에서 완벽하게 설명되지 않는다는 것을 시사한다.</p>
</section>
<section id="고유값eigen-value-요인이-설명하는-총-분산" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="고유값eigen-value-요인이-설명하는-총-분산"><span class="header-section-number">9.3.3</span> 고유값(eigen value): 요인이 설명하는 총 분산</h3>
<p>각 요인은 데이터를 구성하는 전체 분산 중 일부를 설명한다. 고유값(Eigen value)은 각 요인이 설명하는 분산의 총량이다. 일반적으로 고유값이 1 이상인 요인만 해석에 포함시킨다.</p>
<p>회전 후 분석 결과에 따르면, 세 개 요인의 고유값은 각각 2.064, 2.015, 1.917이다. 이는 각 요인이 약 2개의 문항 분산 정도를 설명하고 있다는 의미이며, 이 기준을 충족하므로 세 요인 모두 유지된다.</p>
</section>
<section id="설명된-총분산total-variance-explained-전체-데이터에서-요인이-설명하는-비율" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4" class="anchored" data-anchor-id="설명된-총분산total-variance-explained-전체-데이터에서-요인이-설명하는-비율"><span class="header-section-number">9.3.4</span> 설명된 총분산(Total Variance Explained): 전체 데이터에서 요인이 설명하는 비율</h3>
<p>전체 9개의 문항 중 세 개의 요인이 설명하는 누적 분산 비율은 66.6%로 나타났다. 이는 설문 데이터에서 세 개 요인으로 전체의 3분의 2 이상을 설명할 수 있다는 것을 의미한다. 사회과학에서는 누적설명력이 60% 이상이면 충분하다고 간주한다.</p>
<table class="table-striped table-hover table">
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: center;">고유값</th>
<th style="text-align: center;">설명비율</th>
<th style="text-align: center;">누적 설명비율</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">PA1</td>
<td style="text-align: center;">2.064</td>
<td style="text-align: center;">22.9%</td>
<td style="text-align: center;">22.9%</td>
</tr>
<tr class="even">
<td style="text-align: center;">PA2</td>
<td style="text-align: center;">2.015</td>
<td style="text-align: center;">22.4%</td>
<td style="text-align: center;">45.3%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">PA3</td>
<td style="text-align: center;">1.917</td>
<td style="text-align: center;">21.3%</td>
<td style="text-align: center;">66.6%</td>
</tr>
</tbody>
</table>
</section>
<section id="varimax-회전-전후-결과-비교" class="level3" data-number="9.3.5">
<h3 data-number="9.3.5" class="anchored" data-anchor-id="varimax-회전-전후-결과-비교"><span class="header-section-number">9.3.5</span> Varimax 회전 전후 결과 비교</h3>
<p>회전을 적용하지 않았을 때는 각 문항이 여러 요인에 적재되어 해석이 모호한 경향이 있었으나, Varimax 회전 후에는 대부분의 문항이 단일 요인에 강하게 적재되어 요인 해석이 뚜렷해졌다. 특히 Q7, Q8, Q9는 모두 요인1에 강하게 적재되어 친절 관련 항목임을 명확하게 보여주고 있다. Q4 ~ Q6는 환경, Q1 ~ Q3은 음식에 관련된 문항으로 군집화되었다.</p>
</section>
<section id="왜-varimax가-꼭-필요한가" class="level3" data-number="9.3.6">
<h3 data-number="9.3.6" class="anchored" data-anchor-id="왜-varimax가-꼭-필요한가"><span class="header-section-number">9.3.6</span> 왜 Varimax가 꼭 필요한가?</h3>
<p>회전하지 않은 요인해석은 흐릿한 안경을 쓰고 세상을 보는 것과 같다. 모든 문항이 흐릿하게 여러 요인에 걸쳐 적재되므로 어떤 요인이 무엇을 의미하는지 해석하기가 어렵다. Varimax 회전은 안경을 닦아주는 것과 같아서, 각 요인이 어떤 문항들과 연관되어 있는지를 선명하게 보여준다. 특히 외식산업 설문 분석에서 각 문항이 명확히 어떤 차원을 대표하는지 아는 것은 매우 중요하다.</p>
<p>이는 <strong>Varimax 회전의 목적이 문항과 요인 간의 관계를 단순화하고 해석력을 높이는 것</strong>이라는 이론적 설명과 일치한다. 다만 주의 할 점은 Varimax 회전이 절대적으로 맞다는 것은 아니다. 애초에 우리가 만든 설문의 요인(개념)이 친절, 환경, 음식이라는 다소 상관성이 낮은 개념을 엮었기 때문이다. 문제의 핵심은 <strong>이 세 축이 전혀 상관성이 없느냐</strong>라는 것이다. 만약, 요인간 상관성이 꽤 높을 수 밖에 없는 설문을 만들었다면, 애초에 Varimax가 아닌 다른 회전방법을 사용해야 한다. 왜냐하면, Varimax는 요인간 상관관계를 강제로 0으로 만드는 회전방법이기 때문이다.</p>
</section>
<section id="문항별-요인구조의-비교와-해석-전략" class="level3" data-number="9.3.7">
<h3 data-number="9.3.7" class="anchored" data-anchor-id="문항별-요인구조의-비교와-해석-전략"><span class="header-section-number">9.3.7</span> 문항별 요인구조의 비교와 해석 전략</h3>
<p>아래는 Varimax 회전 후 요인별로 주로 적재된 문항을 정리한 표이다.</p>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: center;">대표 문항</th>
<th style="text-align: left;">해석된 요인의 개념</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">요인1</td>
<td style="text-align: center;">Q7, Q8, Q9</td>
<td style="text-align: left;">음식 품질 만족 요인 (Food Quality)</td>
</tr>
<tr class="even">
<td style="text-align: center;">요인2</td>
<td style="text-align: center;">Q4, Q5, Q6</td>
<td style="text-align: left;">매장 환경 및 청결 요인 (Cleanliness &amp; Atmosphere)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">요인3</td>
<td style="text-align: center;">Q1, Q2, Q3</td>
<td style="text-align: left;">종업원 서비스 태도 요인 (Service Kindness)</td>
</tr>
</tbody>
</table>
<p>이처럼 요인별로 적재량이 높은 문항들을 중심으로 요인의 개념을 정의할 수 있다. 특히 Q8, Q9는 0.8 이상의 적재값을 보여 강력한 요인 대표 문항이라 할 수 있다. 이러한 분석을 통해 설문지를 간결화하거나 핵심 요인을 중심으로 마케팅 전략을 설계하는 데 활용할 수 있다.</p>
</section>
<section id="요인적합도-지표-해석" class="level3" data-number="9.3.8">
<h3 data-number="9.3.8" class="anchored" data-anchor-id="요인적합도-지표-해석"><span class="header-section-number">9.3.8</span> 요인적합도 지표 해석</h3>
<p>TLI는 1.017, RMSEA는 0으로, 모두 모형이 데이터에 매우 잘 적합된다는 것을 의미한다. RMSR은 0.011로, 일반적으로 0.05 이하이면 적합도가 양호하다고 본다. BIC가 -55.893으로 음수이며, 이는 모형이 비교적 단순하면서도 데이터 적합도가 높다는 의미이다. 전반적으로 회전된 3요인 모형은 매우 좋은 적합도를 보이며, 요인구조가 간명하고 실용적인 해석이 가능하다.</p>
</section>
<section id="외식산업-적용-사례-해석" class="level3" data-number="9.3.9">
<h3 data-number="9.3.9" class="anchored" data-anchor-id="외식산업-적용-사례-해석"><span class="header-section-number">9.3.9</span> 외식산업 적용 사례 해석</h3>
<p>예를 들어 한 외식 프랜차이즈 본부에서 고객 만족도를 조사하기 위해 위와 같은 9개 문항을 사용했다고 하자. 분석 결과, 친절, 환경, 음식이라는 세 가지 요인으로 문항이 뚜렷하게 분류되었다면, 본부는 이 세 가지 핵심 서비스 요소에 맞춰 인력 교육, 인테리어 개선, 메뉴 리뉴얼 등의 전략을 분산시켜 시행할 수 있다. 또한 각 점포의 데이터를 활용해 어떤 요인에서 낮은 점수를 받았는지를 확인함으로써 점포별 맞춤 전략 수립도 가능하다.</p>
</section>
<section id="분석-코드-재확인" class="level3" data-number="9.3.10">
<h3 data-number="9.3.10" class="anchored" data-anchor-id="분석-코드-재확인"><span class="header-section-number">9.3.10</span> 분석 코드 재확인</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인 수 확인: Scree plot</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(data, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in fa.stats(r = r, f = f, phi = phi, n.obs = n.obs, np.obs = np.obs, :
The estimated weights for the factor scores are probably incorrect.  Try a
different factor score estimation method.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in fac(r = r, nfactors = nfactors, n.obs = n.obs, rotate = rotate, : An
ultra-Heywood case was detected.  Examine the results carefully</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  3  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 무회전 요인분석</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fa_pa_unrotated <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Varimax 회전 요인분석</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>fa_pa_rotated <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 비교</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_pa_unrotated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  pa
Call: fa(r = data, nfactors = 3, rotate = "none", fm = "pa")
Standardized loadings (pattern matrix) based upon correlation matrix
     PA1  PA2   PA3   h2   u2 com
Q1 -0.17 0.33  0.66 0.58 0.42 1.6
Q2 -0.17 0.37  0.72 0.69 0.31 1.6
Q3 -0.07 0.31  0.75 0.66 0.34 1.4
Q4 -0.49 0.57 -0.35 0.69 0.31 2.6
Q5 -0.46 0.60 -0.35 0.69 0.31 2.6
Q6 -0.53 0.51 -0.30 0.63 0.37 2.6
Q7  0.62 0.50 -0.12 0.66 0.34 2.0
Q8  0.67 0.50 -0.12 0.72 0.28 1.9
Q9  0.69 0.45 -0.07 0.69 0.31 1.7

                       PA1  PA2  PA3
SS loadings           2.11 1.99 1.89
Proportion Var        0.23 0.22 0.21
Cumulative Var        0.23 0.46 0.67
Proportion Explained  0.35 0.33 0.32
Cumulative Proportion 0.35 0.68 1.00

Mean item complexity =  2
Test of the hypothesis that 3 factors are sufficient.

df null model =  36  with the objective function =  4.1 with Chi Square =  800.63
df of  the model are 12  and the objective function was  0.04 

The root mean square of the residuals (RMSR) is  0.01 
The df corrected root mean square of the residuals is  0.02 

The harmonic n.obs is  200 with the empirical chi square  1.72  with prob &lt;  1 
The total n.obs was  200  with Likelihood Chi Square =  7.69  with prob &lt;  0.81 

Tucker Lewis Index of factoring reliability =  1.017
RMSEA index =  0  and the 90 % confidence intervals are  0 0.046
BIC =  -55.89
Fit based upon off diagonal values = 1
Measures of factor score adequacy             
                                                   PA1  PA2  PA3
Correlation of (regression) scores with factors   0.93 0.93 0.92
Multiple R square of scores with factors          0.87 0.86 0.85
Minimum correlation of possible factor scores     0.74 0.72 0.69</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_pa_rotated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  pa
Call: fa(r = data, nfactors = 3, rotate = "varimax", fm = "pa")
Standardized loadings (pattern matrix) based upon correlation matrix
     PA1   PA2   PA3   h2   u2 com
Q1 -0.02  0.05  0.76 0.58 0.42   1
Q2 -0.01  0.04  0.83 0.69 0.31   1
Q3  0.03 -0.06  0.81 0.66 0.34   1
Q4  0.00  0.83  0.00 0.69 0.31   1
Q5  0.04  0.83  0.00 0.69 0.31   1
Q6 -0.07  0.79  0.03 0.63 0.37   1
Q7  0.81  0.03  0.00 0.66 0.34   1
Q8  0.85  0.00 -0.01 0.72 0.28   1
Q9  0.83 -0.07  0.01 0.69 0.31   1

                       PA1  PA2  PA3
SS loadings           2.06 2.02 1.92
Proportion Var        0.23 0.22 0.21
Cumulative Var        0.23 0.45 0.67
Proportion Explained  0.34 0.34 0.32
Cumulative Proportion 0.34 0.68 1.00

Mean item complexity =  1
Test of the hypothesis that 3 factors are sufficient.

df null model =  36  with the objective function =  4.1 with Chi Square =  800.63
df of  the model are 12  and the objective function was  0.04 

The root mean square of the residuals (RMSR) is  0.01 
The df corrected root mean square of the residuals is  0.02 

The harmonic n.obs is  200 with the empirical chi square  1.72  with prob &lt;  1 
The total n.obs was  200  with Likelihood Chi Square =  7.69  with prob &lt;  0.81 

Tucker Lewis Index of factoring reliability =  1.017
RMSEA index =  0  and the 90 % confidence intervals are  0 0.046
BIC =  -55.89
Fit based upon off diagonal values = 1
Measures of factor score adequacy             
                                                   PA1  PA2  PA3
Correlation of (regression) scores with factors   0.93 0.93 0.92
Multiple R square of scores with factors          0.87 0.86 0.85
Minimum correlation of possible factor scores     0.74 0.72 0.69</code></pre>
</div>
</div>
</section>
<section id="r-vs-spss-요인분석-알고리즘-비교" class="level3" data-number="9.3.11">
<h3 data-number="9.3.11" class="anchored" data-anchor-id="r-vs-spss-요인분석-알고리즘-비교"><span class="header-section-number">9.3.11</span> R vs SPSS 요인분석 알고리즘 비교</h3>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">항목</th>
<th style="text-align: left;">R (psych 패키지)</th>
<th style="text-align: left;">SPSS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">주 요인추출 방법</td>
<td style="text-align: left;">Principal Axis Factoring (“pa”)</td>
<td style="text-align: left;">PAF, Maximum Likelihood, Principal Component</td>
</tr>
<tr class="even">
<td style="text-align: center;">회전 방식</td>
<td style="text-align: left;">varimax, promax, oblimin 등 다양</td>
<td style="text-align: left;">Varimax, Promax, Direct Oblimin 등</td>
</tr>
<tr class="odd">
<td style="text-align: center;">적합도 지표 제공</td>
<td style="text-align: left;">RMSR, TLI, RMSEA, BIC 등 제공</td>
<td style="text-align: left;">KMO, Bartlett, Total Variance Explained 등</td>
</tr>
<tr class="even">
<td style="text-align: center;">시각화 지원</td>
<td style="text-align: left;">Scree plot, loading barplot 등 다양</td>
<td style="text-align: left;">제한적 (그래픽 시각화 제한)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">확장성과 통제력</td>
<td style="text-align: left;">코드 기반으로 완전한 통제 가능</td>
<td style="text-align: left;">GUI 기반, 설정 제한 있음</td>
</tr>
</tbody>
</table>
<p>복잡한 데이터일수록 두 소프트웨어 간 결과 차이가 날 수 있는데, 이는 다음과 같은 이유에서 기인한다:</p>
<p><strong>1.</strong> SPSS는 기본적으로 정규분포를 가정하며 ML(Maximum Likelihood) 방식을 선호하지만, R에서는 비정규성에 강한 PAF(Principal Axis Factoring)를 많이 사용한다. <br> <strong>2.</strong> 회전 방식이나 요인 수 선택 기준이 다를 수 있다 (예: SPSS는 Eigenvalue &gt; 1 기준, R은 Scree plot 또는 parallel analysis 사용). <br> <strong>3.</strong> missing data 처리 방식, 변수 스케일 조정, 또는 표준화 기준의 차이도 결과에 영향을 미친다. <br></p>
<p>따라서 동일한 데이터를 사용하더라도 도구마다 결과는 조금씩 다르게 나올 수 있으며, <strong>해석 시 각 알고리즘의 가정과 특성을 정확히 이해하고 선택하는 것이 중요하다.</strong></p>
</section>
</section>
<section id="요인점수란-무엇인가" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="요인점수란-무엇인가"><span class="header-section-number">9.4</span> 요인점수란 무엇인가</h2>
<p>요인점수는 요인분석을 통해 도출된 각 요인에 대해, <strong>개별 응답자(또는 관측 단위)</strong>가 해당 요인에 대해 어느 정도의 수준을 보이는지를 나타내는 수치이다. 이는 일종의 새로운 연속형 변수이며, 기존 변수들의 선형 조합으로 계산된다. 요인점수는 <strong>평균이 0, 표준편차가 1</strong>인 표준화된 값으로, <strong>각 요인에서 응답자의 상대적 위치</strong>를 나타낸다.</p>
<p>예를 들어 어떤 고객이 외식 서비스 품질에 대해 응답한 설문에서, 요인1(예: “서비스 만족도”)의 점수가 +2라면, 이는 평균보다 매우 높은 수준의 만족도를 보였다는 의미이다. 반대로 -1.5라면, 해당 요인에 대한 만족도가 평균보다 낮음을 나타낸다.</p>
<section id="수학적-표현과-개념적-구조" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="수학적-표현과-개념적-구조"><span class="header-section-number">9.4.1</span> 수학적 표현과 개념적 구조</h3>
<p>요인분석의 수학적 기본구조는 다음과 같이 요약된다.</p>
<p><span class="math display">\[
X_j = \lambda_{j1}F_1 + \lambda_{j2}F_2 + \cdots + \lambda_{jm}F_m + \epsilon_j
\]</span></p>
<p>여기서:</p>
<p><strong>-</strong> <span class="math inline">\(X_j\)</span>는 원래 변수 (예: 설문문항) <br> <strong>-</strong> <span class="math inline">\(\lambda_{ji}\)</span>는 요인적재량 (factor loading) <br> <strong>-</strong> <span class="math inline">\(F_m\)</span>은 잠재요인 (factor) <br> <strong>-</strong> <span class="math inline">\(\epsilon_j\)</span>는 고유요인 또는 오차항이다. <br></p>
<p>이 모델에서 각 요인 <span class="math inline">\(F_m\)</span>은 관측된 변수들의 가중합으로 계산되며, 그 가중치는 factor loading 또는 계산된 가중계수이다.</p>
</section>
<section id="요인점수-계산-방식" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="요인점수-계산-방식"><span class="header-section-number">9.4.2</span> 요인점수 계산 방식</h3>
<p>R에서는 <code>psych::fa()</code> 함수를 통해 요인분석을 수행하면, 자동으로 요인점수를 계산하여 출력하거나 <code>factor.scores()</code> 함수를 통해 별도로 추출할 수 있다. 이 점수는 기본적으로 회귀법(regression method)을 이용하여 계산된다.</p>
<p>요인점수는 다음 수식을 통해 계산된다.</p>
<p><span class="math display">\[
F_i = w_{i1}X_1 + w_{i2}X_2 + \cdots + w_{ip}X_p
\]</span></p>
<p>여기서 <span class="math inline">\(w_{ij}\)</span>는 각 변수에 부여된 가중치이며, <span class="math inline">\(X_p\)</span>는 각 응답자의 표준화된 응답값이다. 이는 곧, <strong>표준화된 원자료와 요인점수 가중치 행렬의 곱</strong>이다.</p>
</section>
<section id="요인점수의-특징" class="level3" data-number="9.4.3">
<h3 data-number="9.4.3" class="anchored" data-anchor-id="요인점수의-특징"><span class="header-section-number">9.4.3</span> 요인점수의 특징</h3>
<p>요인점수는 다음과 같은 특성을 가진다.</p>
<p><strong>-</strong> 평균 0, 분산 1의 표준화된 연속형 변수 <br> <strong>-</strong> 변수 점수와 요인적재량을 이용한 선형결합으로 계산됨 <br> <strong>-</strong> 관측 단위가 각 요인에서 어느 정도 위치에 있는지를 정량적으로 표현 <br> <strong>-</strong> 추정된 요인점수 간에는 상관이 없도록 계산되는 경우도 있음 (orthogonal) <br> <strong>-</strong> 추후 분석에서 새로운 변수로 활용 가능 (예: 요인점수를 활용한 고객 군집화) <br></p>
</section>
<section id="r-실습-예제-외식서비스-품질-요인점수-계산" class="level3" data-number="9.4.4">
<h3 data-number="9.4.4" class="anchored" data-anchor-id="r-실습-예제-외식서비스-품질-요인점수-계산"><span class="header-section-number">9.4.4</span> R 실습 예제: 외식서비스 품질 요인점수 계산</h3>
<p>다음은 외식서비스에 대한 9개 문항(Q1 ~ Q9)을 이용한 요인분석 후, 요인점수를 계산하는 과정이다. 데이터는 앞서 생성한 <code>data</code> 객체를 활용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인분석 수행 (Varimax 회전, 3요인)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(<span class="at">r =</span> data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인점수 계산</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>fscores <span class="ot">&lt;-</span> <span class="fu">factor.scores</span>(data, fa_result)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 첫 번째 응답자의 요인점수 확인</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fscores<span class="sc">$</span>scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PA1         PA2        PA3
[1,]  0.1960193  1.70542405 -0.3438852
[2,] -1.5400681  1.26632314 -0.7310611
[3,] -0.2585698 -0.07067042  2.1203149
[4,]  1.0330083 -0.02703891 -0.1842769
[5,]  1.0444897 -0.39395768  0.1898073
[6,] -1.5562838 -0.07944643  2.1211005</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인점수 요약</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fscores<span class="sc">$</span>scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PA1                PA2                PA3         
 Min.   :-2.89598   Min.   :-2.71886   Min.   :-2.1509  
 1st Qu.:-0.64187   1st Qu.:-0.52670   1st Qu.:-0.7209  
 Median :-0.05189   Median :-0.03371   Median : 0.1461  
 Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000  
 3rd Qu.: 0.64986   3rd Qu.: 0.78694   3rd Qu.: 0.6978  
 Max.   : 2.34543   Max.   : 2.63539   Max.   : 2.1412  </code></pre>
</div>
</div>
<p>이때 출력되는 <code>fscores$scores</code> 객체는 아래와 같은 구조를 가진다.</p>
<table class="table-striped table-hover table">
<thead>
<tr class="header">
<th style="text-align: center;">PA1</th>
<th style="text-align: center;">PA2</th>
<th style="text-align: center;">PA3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1.24</td>
<td style="text-align: center;">-0.21</td>
<td style="text-align: center;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.77</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">-0.33</td>
</tr>
</tbody>
</table>
<p>이 표에서 각 행은 응답자(또는 관측치), 각 열은 요인점수를 의미한다. 예를 들어 첫 번째 고객은 요인1에서는 평균보다 높은 점수(+1.24)를, 요인2에서는 낮은 점수(-0.21)를 보이고 있다.</p>
</section>
<section id="요인점수-결과-시각화-및-분포-확인" class="level3" data-number="9.4.5">
<h3 data-number="9.4.5" class="anchored" data-anchor-id="요인점수-결과-시각화-및-분포-확인"><span class="header-section-number">9.4.5</span> 요인점수 결과 시각화 및 분포 확인</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 히스토그램으로 요인점수 분포 확인</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>factor_scores <span class="ot">&lt;-</span> fscores<span class="sc">$</span>scores</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(factor_scores[,<span class="dv">1</span>], <span class="at">main =</span> <span class="st">"Factor 1 요인점수 분포"</span>, <span class="at">xlab =</span> <span class="st">"Factor 1"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(factor_scores[,<span class="dv">2</span>], <span class="at">main =</span> <span class="st">"Factor 2 요인점수 분포"</span>, <span class="at">xlab =</span> <span class="st">"Factor 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(factor_scores[,<span class="dv">3</span>], <span class="at">main =</span> <span class="st">"Factor 3 요인점수 분포"</span>, <span class="at">xlab =</span> <span class="st">"Factor 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>각 요인점수는 대략적으로 정규분포를 따르며, 평균이 0, 분산이 1로 표준화되어 있음을 확인할 수 있다.</p>
</section>
<section id="외식산업-예시로-본-요인점수-해석" class="level3" data-number="9.4.6">
<h3 data-number="9.4.6" class="anchored" data-anchor-id="외식산업-예시로-본-요인점수-해석"><span class="header-section-number">9.4.6</span> 외식산업 예시로 본 요인점수 해석</h3>
<p>실제 외식서비스 만족도 조사를 통해 3개의 요인(서비스태도, 청결성, 분위기)이 추출되었다고 가정하자. 이때 한 고객의 요인점수가 다음과 같다면:</p>
<table class="table-striped table-hover table">
<thead>
<tr class="header">
<th style="text-align: center;">서비스태도</th>
<th style="text-align: center;">청결성</th>
<th style="text-align: center;">분위기</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1.5</td>
<td style="text-align: center;">-0.2</td>
<td style="text-align: center;">0.8</td>
</tr>
</tbody>
</table>
<p>이는 해당 고객이 다른 고객에 비해 <strong>서비스태도에 매우 만족</strong>했고, <strong>청결성에는 평균 이하의 인식</strong>, <strong>분위기에 대해서는 약간 긍정적인 인식</strong>을 보였다는 것을 의미한다.</p>
<p>이를 통해 외식기업은 고객의 세부 인식 구조를 이해하고, <strong>어떤 영역에서 개선이 필요한지</strong>, 혹은 <strong>어떤 강점을 마케팅에 활용할 수 있는지</strong>를 파악할 수 있다.</p>
</section>
<section id="요인점수의-해석과-활용" class="level3" data-number="9.4.7">
<h3 data-number="9.4.7" class="anchored" data-anchor-id="요인점수의-해석과-활용"><span class="header-section-number">9.4.7</span> 요인점수의 해석과 활용</h3>
<p>요인점수는 개별 요인에서 <strong>각 응답자의 상대적 위치</strong>를 수치적으로 보여주는 지표이다. 이 값은 다음과 같은 방식으로 다양하게 활용할 수 있다.</p>
<p><strong>회귀분석</strong>: 요인점수를 종속변수 또는 독립변수로 활용하여 예측모델을 구축할 수 있다. 예를 들어, 서비스만족 요인이 고객 재방문의도에 미치는 영향을 분석할 수 있다.</p>
<p><strong>군집분석</strong>: 요인점수를 기준으로 고객을 유사한 집단으로 분류할 수 있다. 이는 외식업체가 맞춤형 마케팅을 할 수 있는 기반을 제공한다.</p>
<p><strong>경로분석/구조방정식모형</strong>: 요인 간의 인과관계를 가설로 설정하고, 이를 구조모형 내에서 분석할 수 있다.</p>
</section>
<section id="요인점수-활용-예-고객-군집분석" class="level3" data-number="9.4.8">
<h3 data-number="9.4.8" class="anchored" data-anchor-id="요인점수-활용-예-고객-군집분석"><span class="header-section-number">9.4.8</span> 요인점수 활용 예: 고객 군집분석</h3>
<p>요인점수를 기반으로 고객을 세 그룹으로 군집화해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># k-means 군집분석</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>k_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(factor_scores, <span class="at">centers =</span> <span class="dv">3</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(k_result<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3 
49 80 71 </code></pre>
</div>
</div>
<p>이 결과를 바탕으로 3개의 그룹으로 으로 분류할 수 있다. 군집별로 요인점수 평균을 비교해보면 다음과 같다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(factor_scores, <span class="at">by =</span> <span class="fu">list</span>(<span class="at">cluster =</span> k_result<span class="sc">$</span>cluster), <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster        PA1        PA2         PA3
1       1 -0.2777735 -1.2529897 -0.05291383
2       2 -0.6893200  0.6139195 -0.20050152
3       3  0.9684014  0.1729991  0.26243520</code></pre>
</div>
</div>
<p>위 결과를 보면, 첫 번째 그룹은 모든 요인에 불만족한 그룹이고, 세 번째 그룸은 모든 요인에 대해서 만족한 그룹이다. 두 번째 그룹은 매장 환경 및 청결상태에 대해서만 만족한 고객 그룹이라고 할 수 있다. 이런 경우 첫 번째 고객들이 중요한 고객이라고 할 수 있다. 이들은 다시는 재방문 할 가능성이 낮기 때문이다. 또한 이 고객들의 불만 원인을 찾아서 해결하는 것이 향후 매장의 실적에 분명 도움이 될 것이다.</p>
</section>
<section id="후속분석에서의-활용-예제" class="level3" data-number="9.4.9">
<h3 data-number="9.4.9" class="anchored" data-anchor-id="후속분석에서의-활용-예제"><span class="header-section-number">9.4.9</span> 후속분석에서의 활용 예제</h3>
<p>요인점수는 회귀분석에서 독립변수 또는 종속변수로 사용될 수 있다. 예를 들어 요인1이 고객 재방문의도에 어떤 영향을 주는지를 회귀분석으로 검토할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 가상의 종속변수(재방문 의도) 생성</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>revisit <span class="ot">&lt;-</span> factor_scores[,<span class="dv">1</span>]<span class="sc">*</span><span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(data), <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀분석</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>lm_result <span class="ot">&lt;-</span> <span class="fu">lm</span>(revisit <span class="sc">~</span> factor_scores[,<span class="dv">1</span>] <span class="sc">+</span> factor_scores[,<span class="dv">2</span>] <span class="sc">+</span> factor_scores[,<span class="dv">3</span>])</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = revisit ~ factor_scores[, 1] + factor_scores[, 2] + 
    factor_scores[, 3])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.13255 -0.50125 -0.08564  0.51963  2.70124 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         0.007027   0.064636   0.109    0.914    
factor_scores[, 1]  0.457058   0.064798   7.054 2.92e-11 ***
factor_scores[, 2] -0.078981   0.064798  -1.219    0.224    
factor_scores[, 3]  0.051432   0.064798   0.794    0.428    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9141 on 196 degrees of freedom
Multiple R-squared:  0.2093,    Adjusted R-squared:  0.1972 
F-statistic: 17.29 on 3 and 196 DF,  p-value: 5.315e-10</code></pre>
</div>
</div>
<p>위의 분석결과 음식품질 요인이 고객의 재방문에 유의한 영향이 있는 것으로 나타났다. 결국 외식산업에서는 맛이 가장 중요한 재방문의 요인이라고 볼 수 있는 것이다.</p>
</section>
<section id="요약-정리" class="level3" data-number="9.4.10">
<h3 data-number="9.4.10" class="anchored" data-anchor-id="요약-정리"><span class="header-section-number">9.4.10</span> 요약 정리</h3>
<p>요인점수는 요인분석의 결과를 구체적인 수치로 응답자 단위에서 활용 가능하게 만들어주는 핵심 도구이다. 이는 다양한 후속 통계 분석과 실무 의사결정에 직결되며, 외식산업에서는 고객 세분화, 맞춤형 전략, 품질평가 등의 영역에 필수적으로 활용될 수 있다.</p>
<p>다음 장에서는 이러한 요인점수를 활용한 <strong>요인기반 군집분석</strong>을 다루며, 실제 외식고객 데이터를 기반으로 세그먼트 전략을 도출해본다.</p>
</section>
</section>
<section id="요인회전의-개념" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="요인회전의-개념"><span class="header-section-number">9.5</span> 요인회전의 개념</h2>
<p>요인회전(Factor Rotation)은 요인분석에서 도출된 요인적재량 행렬을 보다 <strong>해석하기 쉬운 형태로 바꾸는 과정</strong>이다. 요인분석을 통해 얻어진 <strong>요인적재량은 수학적으로 유일하지 않다.</strong> 같은 데이터를 설명하는 여러 개의 요인구조가 존재할 수 있기 때문에, 해석을 단순화하고 명확한 요인별 구조를 도출하기 위해 <strong>회전이 필요</strong>하다.</p>
<p>요인회전의 궁극적인 목적은 <strong>단순구조(simple structure)</strong>를 얻는 것이다. 단순구조란, 각 요인이 특정 변수들에 대해서는 높은 적재량을, 나머지 변수들에 대해서는 거의 0에 가까운 적재량을 갖는 구조를 의미한다. 이는 각 요인을 명확하게 구분하고 해석 가능하게 만든다.</p>
<section id="요인회전의-종류-직교-vs-비직교" class="level3" data-number="9.5.1">
<h3 data-number="9.5.1" class="anchored" data-anchor-id="요인회전의-종류-직교-vs-비직교"><span class="header-section-number">9.5.1</span> 요인회전의 종류: 직교 vs 비직교</h3>
<p>요인회전 방식은 요인 간 <strong>상관관계의 허용 여부에 따라 크게 두 가지로 나뉜다.</strong></p>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 19%">
<col style="width: 29%">
<col style="width: 13%">
<col style="width: 35%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">구분</th>
<th style="text-align: center;">방식</th>
<th style="text-align: center;">대표 방법</th>
<th style="text-align: left;">요인 간 상관</th>
<th>특징</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">직교회전 (Orthogonal)</td>
<td style="text-align: center;">Varimax, Quartimax, Equamax</td>
<td style="text-align: center;">허용하지 않음 (0)</td>
<td style="text-align: left;">요인 간 완전 독립을 가정하며 해석이 명확함</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center;">비직교회전 (Oblique)</td>
<td style="text-align: center;">Promax, Direct Oblimin</td>
<td style="text-align: center;">허용함</td>
<td style="text-align: left;">요인 간 일정 수준의 상관관계를 가정, 현실적인 모델링에 적합</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>직교회전은 통계적으로 해석이 단순하고 결과가 명확</strong>하게 나뉘기 때문에 <strong>초보 연구자나 이론적으로 요인 간 독립성을 가정할 때</strong> 많이 사용된다. 반면 <strong>비직교회전은 실제 사회현상처럼 요인 간 상관이 있을 수 있다는 전제하</strong>에 보다 <strong>현실적인 모델</strong>을 제시할 수 있다.</p>
</section>
<section id="외식산업-예제-직교회전과-비직교회전-비교" class="level3" data-number="9.5.2">
<h3 data-number="9.5.2" class="anchored" data-anchor-id="외식산업-예제-직교회전과-비직교회전-비교"><span class="header-section-number">9.5.2</span> 외식산업 예제: 직교회전과 비직교회전 비교</h3>
<p>외식서비스에 대한 고객 평가 문항 9개를 바탕으로 요인분석을 실시하고, 각각 Varimax와 Promax 회전을 적용하여 요인구조를 비교해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인분석: Varimax 회전 (직교)</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>fa_varimax <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인분석: Promax 회전 (비직교)</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>fa_promax <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"promax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>요인적재량 비교 결과를 확인하면 다음과 같다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fa_varimax<span class="sc">$</span>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
   PA1    PA2    PA3   
Q1                0.757
Q2                0.827
Q3                0.812
Q4         0.830       
Q5         0.830       
Q6         0.789       
Q7  0.811              
Q8  0.846              
Q9  0.827              

                 PA1   PA2   PA3
SS loadings    2.064 2.015 1.917
Proportion Var 0.229 0.224 0.213
Cumulative Var 0.229 0.453 0.666</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fa_promax<span class="sc">$</span>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
   PA1    PA2    PA3   
Q1                0.756
Q2                0.827
Q3                0.813
Q4         0.831       
Q5         0.831       
Q6         0.788       
Q7  0.812              
Q8  0.846              
Q9  0.826              

                 PA1   PA2   PA3
SS loadings    2.064 2.016 1.917
Proportion Var 0.229 0.224 0.213
Cumulative Var 0.229 0.453 0.666</code></pre>
</div>
</div>
<p>Varimax 회전에서는 각 문항이 특정 요인에만 강하게 적재되는 구조가 도출되어 해석이 단순하지만, 요인 간 완전 독립이라는 가정이 현실적으로 타당하지 않을 수도 있다. 반면 Promax 회전은 문항 간 교차적재가 약간 더 존재하지만, 요인 간 상관관계까지 고려하므로 보다 현실적인 모델을 구성할 수 있다.</p>
</section>
<section id="요인-간-상관-확인-비직교회전의-경우" class="level3" data-number="9.5.3">
<h3 data-number="9.5.3" class="anchored" data-anchor-id="요인-간-상관-확인-비직교회전의-경우"><span class="header-section-number">9.5.3</span> 요인 간 상관 확인 (비직교회전의 경우)</h3>
<p>비직교회전을 사용할 경우 요인 간 상관행렬을 따로 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fa_promax<span class="sc">$</span>r.scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]        [,2]         [,3]
[1,]  1.000000000 -0.03688725 -0.003408584
[2,] -0.036887248  1.00000000  0.029513935
[3,] -0.003408584  0.02951393  1.000000000</code></pre>
</div>
</div>
<p>요인 간 상관계수가 0.3 ~ 0.4 수준으로 나타난다면, 요인 간 상관을 고려한 Promax 회전이 이론적으로 더 적절하다고 판단할 수 있다. 앞에서 이야기 했듯이 이 경우는 논리적으로도 위의 요인간 상관계수를 보아도 직교회전 방식인 Varimax가 적당하다고 판단할 수 있다.</p>
<p>그러나, 요인 간 상관이 존재하는 경우에도 무조건적으로 Varimax 회전을 사용하는 것은 해석의 왜곡을 초래할 수 있다. 따라서 이론적 모델과 데이터 특성에 따라 적절한 회전방식을 선택해야 한다.</p>
</section>
<section id="실무-예시-고객-평가-데이터에서의-해석-차이" class="level3" data-number="9.5.4">
<h3 data-number="9.5.4" class="anchored" data-anchor-id="실무-예시-고객-평가-데이터에서의-해석-차이"><span class="header-section-number">9.5.4</span> 실무 예시: 고객 평가 데이터에서의 해석 차이</h3>
<p>예를 들어 다음과 같은 평가 문항들이 있다고 하자.</p>
<p><strong>-</strong> Q1~Q3: 가격 만족도 관련 문항 <br> <strong>-</strong> Q4~Q6: 서비스 응대 태도 관련 문항 <br> <strong>-</strong> Q7~Q9: 매장 청결 및 환경 관련 문항 <br></p>
<p>이 데이터에 대해 Varimax를 적용하면 세 요인이 명확하게 나뉘며 해석은 용이하지만, <strong>만약 고객이 서비스 응대가 좋으면 가격도 긍정적으로 평가하는 경향이 있다면</strong> 요인 간 상관이 존재하는 것이다. 이때 Promax 회전이 보다 현실적인 결과를 제시한다.</p>
<p>요인회전은 단지 기술적인 단계가 아니라 해석의 정확성과 타당성을 확보하는 핵심적 단계이다. 이론적으로 요인 간 독립이 강하게 가정될 경우에는 Varimax 회전이 적절하고, 실무적 맥락이나 사회심리적 요인이 서로 연관되어 있다고 판단된다면 Promax 회전을 적용해야 한다. R과 SPSS 모두 이러한 회전 방식을 지원하며, 결과 해석 시 회전 방식의 차이에 주의할 필요가 있다.</p>
<p>한 가지 조심할 점은 SPSS의 경우 차원축소라는 메뉴 내부에 요인분석이 있는데 이 메뉴에는 요인분석의 알고리즘과 주성분분석의 알고리즘이 섞여 있다는 점이다. 특히, 디폴트로 되어 있는 값이 주성분분석이다. 많은 경우 요인분석이라는 메뉴를 클릭하고 디폴트 값으로 분석을 진행한 후에 리포트할 때, 요인분석을 했다고 리포트를 한다는 점이다. 소프트웨어가 사용하기 쉽다는 점은 자칫 분석가의 전문성을 의심하게 만들 뿐만 아니라 심지어 양심의 문제까지도 의심하게 만든다. 불과 10년 혹은 20년 전과 비교해보면, 데이터 분석이 지금처럼 쉬울 수 없는 시대를 과거에는 생각할 수도 없었다. 문제는 쉬운 것이 문제가 아니라 이 쉬운 툴을 사용하는 분석가가 문제인 것이다.</p>
</section>
<section id="요인회전의-수학적-원리와-시각적-이해" class="level3" data-number="9.5.5">
<h3 data-number="9.5.5" class="anchored" data-anchor-id="요인회전의-수학적-원리와-시각적-이해"><span class="header-section-number">9.5.5</span> 요인회전의 수학적 원리와 시각적 이해</h3>
<p>요인분석에서는 관측된 변수들이 잠재된 소수의 요인들에 의해 설명된다고 가정한다. 하지만 초기 추출된 요인들은 해석이 어려운 구조를 가질 수 있다. 요인회전은 이러한 요인구조를 <strong>보다 명확하고 해석 가능하게 단순화</strong>하기 위한 수학적 변환 과정이다.</p>
</section>
<section id="요인회전의-수학적-원리" class="level3" data-number="9.5.6">
<h3 data-number="9.5.6" class="anchored" data-anchor-id="요인회전의-수학적-원리"><span class="header-section-number">9.5.6</span> 요인회전의 수학적 원리</h3>
<p>회전은 단순히 좌표계를 회전시키는 선형변환(linear transformation)이다. 회전 후에도 각 변수의 분산은 유지되며, 공통성(<span class="math inline">\(h^2\)</span>)도 변하지 않는다.</p>
<p>초기 요인행렬을 <span class="math inline">\(L\)</span> 이라 할 때, 회전된 요인행렬 <span class="math inline">\(L^*\)</span> 은 다음과 같이 표현된다:</p>
<p><span class="math display">\[L^* = L \cdot T\]</span></p>
<p>여기서 <span class="math inline">\(T\)</span> 는 회전행렬(rotation matrix)이며, <strong>직교회전(orthogonal)</strong>의 경우 <span class="math inline">\(T^T T = I\)</span> 를 만족하는 직교행렬이다. 즉, 회전 이후에도 요인 간 상관은 0이다.</p>
<p><strong>비직교회전(oblique rotation)</strong>의 경우 <span class="math inline">\(T\)</span>는 일반 행렬로, 회전 후 요인 간 상관이 0이 아닐 수 있다. 이때 요인행렬 외에도 요인 간 상관을 나타내는 상관행렬(<span class="math inline">\(\phi\)</span>)이 함께 산출된다.</p>
</section>
<section id="직교회전-vs-비직교회전-수학적-예시" class="level3" data-number="9.5.7">
<h3 data-number="9.5.7" class="anchored" data-anchor-id="직교회전-vs-비직교회전-수학적-예시"><span class="header-section-number">9.5.7</span> 직교회전 vs 비직교회전 수학적 예시</h3>
<p><strong>직교회전 예</strong>: Varimax는 요인행렬의 각 열을 가능한 한 0 또는 1에 가깝게 하여 각 변수들이 특정 요인에만 강하게 적재되도록 유도한다.</p>
<p><strong>비직교회전 예</strong>: Promax는 먼저 Varimax로 초기 구조를 만든 후, 요인 간 상관을 허용하며 추가로 회전하여 실제 개념적 연관성을 반영한다.</p>
</section>
<section id="외식산업-예제-고객-평가요인-회전-결과-비교" class="level3" data-number="9.5.8">
<h3 data-number="9.5.8" class="anchored" data-anchor-id="외식산업-예제-고객-평가요인-회전-결과-비교"><span class="header-section-number">9.5.8</span> 외식산업 예제: 고객 평가요인 회전 결과 비교</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GPArotation)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인분석: Varimax (직교)</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>fa_varimax <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인분석: Promax (비직교)</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>fa_promax <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"promax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인 적재량 비교</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>fa_varimax<span class="sc">$</span>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
   PA1    PA2    PA3   
Q1                0.757
Q2                0.827
Q3                0.812
Q4         0.830       
Q5         0.830       
Q6         0.789       
Q7  0.811              
Q8  0.846              
Q9  0.827              

                 PA1   PA2   PA3
SS loadings    2.064 2.015 1.917
Proportion Var 0.229 0.224 0.213
Cumulative Var 0.229 0.453 0.666</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fa_promax<span class="sc">$</span>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
   PA1    PA2    PA3   
Q1                0.756
Q2                0.827
Q3                0.813
Q4         0.831       
Q5         0.831       
Q6         0.788       
Q7  0.812              
Q8  0.846              
Q9  0.826              

                 PA1   PA2   PA3
SS loadings    2.064 2.016 1.917
Proportion Var 0.229 0.224 0.213
Cumulative Var 0.229 0.453 0.666</code></pre>
</div>
</div>
<p>직교회전 결과에서는 각 문항이 특정 요인에 명확히 적재되지만, 요인 간 상관이 존재할 수 있는 경우에는 오히려 해석이 왜곡될 수 있다. Promax는 변수 간 개념적 중복을 인정하며, 현실적 해석에 보다 유리하다.</p>
</section>
<section id="요인-간-관계-시각화-그래프-활용" class="level3" data-number="9.5.9">
<h3 data-number="9.5.9" class="anchored" data-anchor-id="요인-간-관계-시각화-그래프-활용"><span class="header-section-number">9.5.9</span> 요인 간 관계 시각화: 그래프 활용</h3>
<p>요인 간 관계를 시각적으로 표현하면 회전 방식의 차이를 보다 직관적으로 이해할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인 간 상관행렬 시각화 (비직교 회전 시)</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(fa_promax<span class="sc">$</span>Phi, <span class="at">is.corr =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"circle"</span>, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">"Promax 회전: 요인 간 상관관계"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>이 그래프는 Promax 회전 후 요인 간 상관이 존재함을 보여준다. 예를 들어 서비스 품질 요인과 환경 요인이 양(+)의 상관을 가질 수 있는데, 이는 고객이 전반적으로 긍정적 평가를 보일 경우 모든 요인 점수에 영향을 미치기 때문이다.</p>
<p>직교회전의 경우 요인 간 상관행렬이 단위행렬(identity matrix)이기 때문에 위와 같은 시각화를 하지 않는다. 대신, 원형 플롯이나 적재량 기반 변수-요인 관계 시각화가 가능하다.</p>
</section>
<section id="요인구조-시각화-요인적재량-플롯" class="level3" data-number="9.5.10">
<h3 data-number="9.5.10" class="anchored" data-anchor-id="요인구조-시각화-요인적재량-플롯"><span class="header-section-number">9.5.10</span> 요인구조 시각화: 요인적재량 플롯</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 적재량 추출</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fa_varimax<span class="sc">$</span>loadings))  <span class="co"># matrix를 data.frame으로 변환</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>loadings<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loadings)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인 1과 요인 2만 시각화</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(loadings, <span class="fu">aes</span>(<span class="at">x =</span> PA1, <span class="at">y =</span> PA2, <span class="at">label =</span> var)) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Varimax 회전 요인적재도"</span>, <span class="at">x =</span> <span class="st">"요인 1"</span>, <span class="at">y =</span> <span class="st">"요인 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>이 그래프는 각 변수(문항)가 요인 1과 요인 2에 얼마나 적재되어 있는지를 보여준다. 특정 변수들이 하나의 요인에만 뚜렷하게 집중되어 있으면 회전이 잘 수행되었다는 의미다.</p>
<p>다음은 3차원 요인 시각화 결과이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인적재량 데이터프레임</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>loadings_3d <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fa_varimax<span class="sc">$</span>loadings))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>loadings_3d<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loadings_3d)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 문항별로 가장 절대값이 큰 요인 번호를 색상 그룹으로 지정</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>max_factor <span class="ot">&lt;-</span> <span class="fu">max.col</span>(<span class="fu">abs</span>(loadings_3d[, <span class="fu">c</span>(<span class="st">"PA1"</span>, <span class="st">"PA2"</span>, <span class="st">"PA3"</span>)]))</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 색상 팔레트 (Factor 1=파랑, Factor 2=빨강, Factor 3=초록)</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>factor_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>)[max_factor]</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF 전용: 정적 3D 시각화</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(loadings_3d, {</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter3D</span>(PA1, PA2, PA3,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">1.2</span>,            <span class="co"># 포인트 크기</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.8</span>,          <span class="co"># 투명도</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">colvar =</span> <span class="cn">NULL</span>,        <span class="co"># 색상 스케일 비활성화</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> factor_colors,  <span class="co"># 요인별 색상</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">"Factor 1"</span>, <span class="at">ylab =</span> <span class="st">"Factor 2"</span>, <span class="at">zlab =</span> <span class="st">"Factor 3"</span>,</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"3차원 요인적재도 (Varimax, 정적)"</span>,</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">bty =</span> <span class="st">"g"</span>,             <span class="co"># 바닥 그리드</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">col.grid =</span> <span class="st">"grey85"</span>,</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">theta =</span> <span class="dv">35</span>, <span class="at">phi =</span> <span class="dv">20</span>,  <span class="co"># 시점 각도</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">box =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 레이블 추가 (요인별 색상 동일 적용)</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text3D</span>(PA1, PA2, PA3, <span class="at">labels =</span> var,</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> factor_colors)</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 범례 추가</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Factor 1"</span>, <span class="st">"Factor 2"</span>, <span class="st">"Factor 3"</span>),</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">pt.cex =</span> <span class="fl">1.2</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>위의 3차원 그래프를 보면 확실시 세 요인이 서로 직교하는 것을 알 수 있다.</p>
<p>다음은 비직교회전 결과를 시각화한 결과이다. 2D 시각화를 우선 해보자. 여기서는 요인 1 vs 요인 2로 하며 Promax 기준으로 작성하였다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 비직교 회전 (promax) 적용</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fa_promax <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"promax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 적재량 추출</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>loadings_promax <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fa_promax<span class="sc">$</span>loadings))</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>loadings_promax<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loadings_promax)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 시각화</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(loadings_promax, <span class="fu">aes</span>(<span class="at">x =</span> PA1, <span class="at">y =</span> PA2, <span class="at">label =</span> var)) <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Promax 회전 요인적재도"</span>, <span class="at">x =</span> <span class="st">"요인 1"</span>, <span class="at">y =</span> <span class="st">"요인 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Varimax 결과와 매우 유사하게 보인다. 이는 애초에 이 세 개의 개념이 상호간 상관관계가 높지 않도록 설계된 것이 원인이며, 실제로 Promax로 회전한 후에 확인한 요인간 상관관계 역시 상관도가 거의 없었기 때문에 이와 같은 결과가 나오는 것이다.</p>
<p>참고로 3D 그래프도 확인해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인적재량 데이터프레임</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>loadings_prom_3d <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fa_promax<span class="sc">$</span>loadings))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>loadings_prom_3d<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loadings_prom_3d)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 문항별로 가장 절대값이 큰 요인 번호를 색상 그룹으로 지정</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>max_factor_prom <span class="ot">&lt;-</span> <span class="fu">max.col</span>(<span class="fu">abs</span>(loadings_prom_3d[, <span class="fu">c</span>(<span class="st">"PA1"</span>, <span class="st">"PA2"</span>, <span class="st">"PA3"</span>)]))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>factor_colors_prom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>)[max_factor_prom]</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF 전용: 정적 3D 시각화</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(loadings_prom_3d, {</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter3D</span>(PA1, PA2, PA3,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">1.2</span>,           <span class="co"># 포인트 크기</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.8</span>,         <span class="co"># 투명도</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">colvar =</span> <span class="cn">NULL</span>,       <span class="co"># 색상 스케일 비활성화</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> factor_colors_prom,  <span class="co"># 요인별 색상</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">"Factor 1"</span>, <span class="at">ylab =</span> <span class="st">"Factor 2"</span>, <span class="at">zlab =</span> <span class="st">"Factor 3"</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"3차원 요인적재도 (Promax, 정적)"</span>,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">bty =</span> <span class="st">"g"</span>,           </span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">col.grid =</span> <span class="st">"grey85"</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">theta =</span> <span class="dv">35</span>, <span class="at">phi =</span> <span class="dv">20</span>,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">box =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 레이블 추가</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text3D</span>(PA1, PA2, PA3, <span class="at">labels =</span> var,</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> factor_colors_prom)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 범례 추가</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Factor 1"</span>, <span class="st">"Factor 2"</span>, <span class="st">"Factor 3"</span>),</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">pt.cex =</span> <span class="fl">1.2</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>상관관계가 거의 0에 가깝기 때문에 직교하는 관계처럼 보인다. 비직교 회전에서는 요인 간 상관관계를 다시 확인해보면 다음과 같다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>fa_promax<span class="sc">$</span>Phi  <span class="co"># 요인 간 상관행렬</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             PA1         PA2          PA3
PA1  1.000000000 -0.03332704 -0.003336481
PA2 -0.033327036  1.00000000  0.026541283
PA3 -0.003336481  0.02654128  1.000000000</code></pre>
</div>
</div>
<p>앞서 했던 군집분석을 확대해서 이를 그래프로 확인해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인점수 계산 (Varimax 기준)</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">scores =</span> <span class="st">"regression"</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>factor_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fa_result<span class="sc">$</span>scores)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># k-means 군집화</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>k_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(factor_scores, <span class="at">centers =</span> <span class="dv">3</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 클러스터 번호를 요인점수에 추가</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>factor_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(k_result<span class="sc">$</span>cluster)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(factor_scores, <span class="fu">aes</span>(<span class="at">x =</span> PA1, <span class="at">y =</span> PA2, <span class="at">color =</span> cluster)) <span class="sc">+</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"요인점수 기반 고객 군집 시각화 (Factor1 vs Factor2)"</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"요인1 (예: 서비스 만족)"</span>, <span class="at">y =</span> <span class="st">"요인2 (예: 매장 환경)"</span>) <span class="sc">+</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>다음은 3D 그래프이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 군집 색상 팔레트 (cluster가 factor 또는 숫자일 수 있으니 factor로 변환)</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(factor_scores<span class="sc">$</span>cluster)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>cluster_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"purple"</span>, <span class="st">"orange"</span>)[clusters]</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF 전용: 정적 3D 시각화</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(factor_scores, {</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter3D</span>(PA1, PA2, PA3,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">1.2</span>,          <span class="co"># 포인트 크기</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.8</span>,        <span class="co"># 투명도</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">colvar =</span> <span class="cn">NULL</span>,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> cluster_colors,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">"Factor 1"</span>, <span class="at">ylab =</span> <span class="st">"Factor 2"</span>, <span class="at">zlab =</span> <span class="st">"Factor 3"</span>,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"3차원 요인점수 기반 고객 분포 및 군집 (정적)"</span>,</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">bty =</span> <span class="st">"g"</span>,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">col.grid =</span> <span class="st">"grey85"</span>,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">theta =</span> <span class="dv">35</span>, <span class="at">phi =</span> <span class="dv">20</span>,</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">box =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 범례 추가</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">levels</span>(clusters),</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">unique</span>(cluster_colors), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">pt.cex =</span> <span class="fl">1.2</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Cluster"</span>)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>각 군집별 요인점수 평균은 다음과 같다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(. <span class="sc">~</span> cluster, <span class="at">data =</span> factor_scores, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster        PA1        PA2         PA3
1       1 -0.2569039 -1.1617661 -0.05039359
2       2 -0.6870597  0.5939291 -0.16918309
3       3  0.8640644  0.1571724  0.20436268</code></pre>
</div>
</div>
</section>
<section id="실무적-고려-회전-방식-선택-시-유의사항" class="level3" data-number="9.5.11">
<h3 data-number="9.5.11" class="anchored" data-anchor-id="실무적-고려-회전-방식-선택-시-유의사항"><span class="header-section-number">9.5.11</span> 실무적 고려: 회전 방식 선택 시 유의사항</h3>
<p>요인 간 상관이 존재한다고 이론적으로 판단되는 경우, Varimax보다 Promax를 사용하는 것이 해석에 더 적절하다.</p>
<p>예를 들어 외식 서비스에서 ’서비스 품질’과 ’직원의 친절도’가 전혀 독립적이라고 보기 어렵다면, 요인 간 상관을 허용하는 비직교 회전이 이론적으로 더 타당하다.</p>
<p>요약하면, <strong>Varimax는 해석의 명료성을, Promax는 현실적 구조를 반영</strong>한다는 점에서 목적과 맥락에 따라 회전방식을 선택해야 한다.</p>
</section>
</section>
<section id="요인분석의-한계와-주의사항" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="요인분석의-한계와-주의사항"><span class="header-section-number">9.6</span> 요인분석의 한계와 주의사항</h2>
<p>요인분석은 다변량 데이터를 축소하고 구조화하는 데 유용한 분석기법이지만, <strong>절대적인 분석 방법은 아니며 해석에 주의가 필요한 통계기법</strong>이다. 특히 분석의 결과는 사용자의 이론적 해석과 데이터 품질, 회전 방식에 따라 매우 달라질 수 있기 때문에, 그 한계와 전제 조건을 명확히 인식하는 것이 중요하다.</p>
<section id="분산-손실-문제" class="level3" data-number="9.6.1">
<h3 data-number="9.6.1" class="anchored" data-anchor-id="분산-손실-문제"><span class="header-section-number">9.6.1</span> 분산 손실 문제</h3>
<p>요인분석은 원래 데이터의 분산을 축소하여 소수의 요인으로 압축한다. 이 과정에서 평균적으로 전체 정보의 <strong>30 ~ 40% 정도가 손실될 수 있다</strong>. 예를 들어 외식서비스 평가 설문에서 10개의 문항으로 구성된 데이터를 3개의 요인으로 요약할 경우, 요인이 설명하는 총 분산이 65%라면 나머지 35%는 무시되는 셈이다. 이는 모델 단순화의 이점이지만, 동시에 중요한 정보를 버릴 수도 있다는 점에서 해석에 주의가 필요하다.</p>
</section>
<section id="해석-한계와-모호성" class="level3" data-number="9.6.2">
<h3 data-number="9.6.2" class="anchored" data-anchor-id="해석-한계와-모호성"><span class="header-section-number">9.6.2</span> 해석 한계와 모호성</h3>
<p>요인은 통계적으로 추출된 잠재변수로서, 이론적으로 이름을 붙이는 과정이 필수다. 그러나 <strong>요인적재량이 여러 요인에 걸쳐 분포</strong>하거나 <strong>문항 간 개념이 명확하지 않을 경우 해석이 모호</strong>할 수 있다. 예를 들어 Q3와 Q4 문항이 각각 두 개 이상의 요인에 유사하게 적재된다면, 이 요인의 의미를 명확히 정의하기 어렵다. 이는 분석 결과의 신뢰도를 떨어뜨릴 수 있다.</p>
</section>
<section id="설문-품질에-대한-민감성" class="level3" data-number="9.6.3">
<h3 data-number="9.6.3" class="anchored" data-anchor-id="설문-품질에-대한-민감성"><span class="header-section-number">9.6.3</span> 설문 품질에 대한 민감성</h3>
<p>요인분석은 문항 간 공통성을 기반으로 하기 때문에, <strong>측정 항목의 신뢰도가 낮거나 내용이 일관되지 않으면 요인으로 묶이지 않는다</strong>. 예를 들어 외식서비스 평가 설문에서 불성실하게 응답한 문항은 고유요소가 높아 요인에 기여하지 않게 된다. 이는 전체 요인구조를 왜곡하거나 일부 요인을 형성하지 못하게 만들 수 있다.</p>
</section>
<section id="회전-방식-선택의-중요성" class="level3" data-number="9.6.4">
<h3 data-number="9.6.4" class="anchored" data-anchor-id="회전-방식-선택의-중요성"><span class="header-section-number">9.6.4</span> 회전 방식 선택의 중요성</h3>
<p>회전(rotation)은 해석을 용이하게 하는 핵심 절차지만, 무조건적으로 Varimax(직교회전)를 선택하는 것은 위험하다. <strong>이론적으로 요인 간 상관이 존재할 수 있는 경우</strong>, 예를 들어 ’서비스 만족’과 ’매장환경’이 서로 영향을 줄 수 있는 구조라면 Promax(비직교회전)을 사용하는 것이 타당하다. 회전 방식의 선택이 달라지면 요인구조도 크게 달라지므로, <strong>이론적 전제를 바탕으로 명시적으로 선택해야 한다</strong>.</p>
</section>
<section id="요인분석의-전제-조건" class="level3" data-number="9.6.5">
<h3 data-number="9.6.5" class="anchored" data-anchor-id="요인분석의-전제-조건"><span class="header-section-number">9.6.5</span> 요인분석의 전제 조건</h3>
<p>요인분석은 다음의 조건을 만족해야 그 결과를 신뢰할 수 있다.</p>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">조건 항목</th>
<th style="text-align: left;">요건 내용</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">변수 수준</td>
<td style="text-align: left;">등간척도 이상의 연속형 변수여야 한다</td>
</tr>
<tr class="even">
<td style="text-align: center;">변수 분포</td>
<td style="text-align: left;">변수는 대체로 정규분포를 따라야 한다</td>
</tr>
<tr class="odd">
<td style="text-align: center;">관측값의 독립성</td>
<td style="text-align: left;">모든 관측치는 서로 독립적이며 등분산성이 가정된다</td>
</tr>
<tr class="even">
<td style="text-align: center;">표본 크기</td>
<td style="text-align: left;">최소 100명 이상, 또는 변수 수의 4~5배 이상이 권장된다</td>
</tr>
</tbody>
</table>
<p>예를 들어 외식 서비스 품질에 대한 요인분석을 시행할 때, 10개의 문항을 분석한다면 최소 50명 이상보다는 <strong>200명 이상의 표본을 확보하는 것이 안정적</strong>이다. 표본이 부족하면 요인구조가 불안정하고 해석 가능성이 낮아진다.</p>
</section>
<section id="한계-속에서도-요인분석의-가치" class="level3" data-number="9.6.6">
<h3 data-number="9.6.6" class="anchored" data-anchor-id="한계-속에서도-요인분석의-가치"><span class="header-section-number">9.6.6</span> 한계 속에서도 요인분석의 가치</h3>
<p>이러한 제약에도 불구하고 요인분석은 <strong>고차원적인 평가항목을 구조화하고 축약하여</strong> 의미 있는 정보를 도출하는 데 탁월하다. 특히 외식산업에서 서비스 품질, 고객만족, 인지된 가치 등을 구조적으로 파악할 수 있는 수단으로 매우 널리 활용된다. 단, 분석 전에 충분한 설문 설계와 이론 기반 정립이 동반되어야 하며, 결과 해석도 단순한 수치가 아니라 <strong>이론과 실무에 기초한 논리적 설명</strong>이 필수적이다.</p>
<p>요약하자면 요인분석은 통계기법이지만, 동시에 설계 철학과 해석 기준이 요구되는 <strong>이론-방법론 통합적 사고를 필요로 하는 분석도구</strong>이다.</p>
</section>
</section>
<section id="커피전문점-만족도-설문-실습-예제" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="커피전문점-만족도-설문-실습-예제"><span class="header-section-number">9.7</span> 커피전문점 만족도 설문 실습 예제</h2>
<p>본 실습은 실제 외식 소비 데이터를 기반으로 요인분석, 요인점수 계산, 그리고 회귀분석까지 일련의 흐름을 종합적으로 수행하는 것이다. 특히 커피전문점 이용 고객을 대상으로 설계된 만족도 설문 데이터를 바탕으로, 고객의 외적 만족, 내적 만족, 신뢰가 재방문 의도에 어떤 영향을 주는지를 검토한다.</p>
<section id="설문-문항-구성" class="level3" data-number="9.7.1">
<h3 data-number="9.7.1" class="anchored" data-anchor-id="설문-문항-구성"><span class="header-section-number">9.7.1</span> 설문 문항 구성</h3>
<p>분석에 사용된 설문은 다음과 같이 구성되어 있다. 총 34개의 항목이며, 응답은 모두 5점 Likert 척도이다.</p>
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">영역</th>
<th style="text-align: center;">문항 수</th>
<th style="text-align: left;">예시 문항</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">분위기</td>
<td style="text-align: center;">5</td>
<td style="text-align: left;">조용한 분위기, 매장 인테리어</td>
</tr>
<tr class="even">
<td style="text-align: center;">접근성</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">위치, 찾기 쉬움</td>
</tr>
<tr class="odd">
<td style="text-align: center;">편의성</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">좌석 편리성, 공간 여유</td>
</tr>
<tr class="even">
<td style="text-align: center;">친절도</td>
<td style="text-align: center;">5</td>
<td style="text-align: left;">직원의 응대, 설명의 명확성</td>
</tr>
<tr class="odd">
<td style="text-align: center;">맛</td>
<td style="text-align: center;">3</td>
<td style="text-align: left;">커피 맛, 일관성</td>
</tr>
<tr class="even">
<td style="text-align: center;">가격</td>
<td style="text-align: center;">3</td>
<td style="text-align: left;">가격 합리성, 가치 대비 만족</td>
</tr>
<tr class="odd">
<td style="text-align: center;">메뉴</td>
<td style="text-align: center;">3</td>
<td style="text-align: left;">메뉴 다양성, 계절메뉴 만족도</td>
</tr>
<tr class="even">
<td style="text-align: center;">명성</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">브랜드 이미지, 대중 인식</td>
</tr>
<tr class="odd">
<td style="text-align: center;">외만족</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">외부 환경 만족도 (외부 청결, 음악 등)</td>
</tr>
<tr class="even">
<td style="text-align: center;">내만족</td>
<td style="text-align: center;">3</td>
<td style="text-align: left;">내부 환경 만족도 (공간 배치, 채광 등)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">신뢰</td>
<td style="text-align: center;">3</td>
<td style="text-align: left;">브랜드 신뢰, 위생 신뢰</td>
</tr>
<tr class="even">
<td style="text-align: center;">재방문</td>
<td style="text-align: center;">3</td>
<td style="text-align: left;">재방문 의향, 추천 의사</td>
</tr>
</tbody>
</table>
<p>중요한 것은 위의 데이터는 현실 데이터이며, 위의 데이터를 작성하기 전에 설문지를 구성한 사람은 전문가가 아니었다. 데이터의 분석 뿐만 아니라 데이터 수집에 있어서도 전문성이 매우 중요한데, 이러한 전문성의 부재가 데이터의 품질에 미치는 영향을 이번 실습을 통해 분명하게 이해해야 한다. 모든 변수를 다 가지고 분석할 수도 없을 것이지만, 경우에 따라 다양한 아이디어를 바탕으로 데이터 분석을 위한 전처리가 필요할 것이다.</p>
</section>
<section id="데이터-불러오기-및-변수-분리" class="level3" data-number="9.7.2">
<h3 data-number="9.7.2" class="anchored" data-anchor-id="데이터-불러오기-및-변수-분리"><span class="header-section-number">9.7.2</span> 데이터 불러오기 및 변수 분리</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 불러오기</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/ch9_data1.csv"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 변수확인</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      성별          분위기1         분위기2        분위기3         분위기4     
 Min.   :1.000   Min.   :1.000   Min.   :1.00   Min.   :1.000   Min.   :1.000  
 1st Qu.:1.000   1st Qu.:3.000   1st Qu.:3.00   1st Qu.:3.000   1st Qu.:3.000  
 Median :2.000   Median :4.000   Median :3.00   Median :3.000   Median :3.000  
 Mean   :1.596   Mean   :3.831   Mean   :3.27   Mean   :3.463   Mean   :3.481  
 3rd Qu.:2.000   3rd Qu.:5.000   3rd Qu.:4.00   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :2.000   Max.   :5.000   Max.   :5.00   Max.   :5.000   Max.   :5.000  
    분위기5        접근성1         접근성2         접근성3         접근성4     
 Min.   :1.00   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.00   1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000  
 Median :3.00   Median :4.000   Median :3.750   Median :4.000   Median :4.000  
 Mean   :3.55   Mean   :3.617   Mean   :3.579   Mean   :3.757   Mean   :3.986  
 3rd Qu.:4.00   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:5.000  
 Max.   :5.00   Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000  
    편의성1        편의성2        편의성3         편의성4         친절도1     
 Min.   :1.00   Min.   :1.00   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.00   1st Qu.:2.00   1st Qu.:3.000   1st Qu.:2.000   1st Qu.:3.000  
 Median :3.50   Median :3.00   Median :3.000   Median :3.000   Median :3.000  
 Mean   :3.48   Mean   :2.95   Mean   :3.093   Mean   :3.012   Mean   :3.226  
 3rd Qu.:4.00   3rd Qu.:3.00   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :5.00   Max.   :5.00   Max.   :5.000   Max.   :5.000   Max.   :5.000  
    친절도2         친절도3        친절도4        친절도5           맛1       
 Min.   :1.000   Min.   :1.00   Min.   :1.00   Min.   :1.000   Min.   :1.500  
 1st Qu.:3.000   1st Qu.:3.00   1st Qu.:3.00   1st Qu.:3.000   1st Qu.:3.188  
 Median :3.000   Median :4.00   Median :3.00   Median :3.000   Median :3.500  
 Mean   :3.312   Mean   :3.62   Mean   :3.53   Mean   :3.472   Mean   :3.625  
 3rd Qu.:4.000   3rd Qu.:4.00   3rd Qu.:4.00   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :5.000   Max.   :5.00   Max.   :5.00   Max.   :5.000   Max.   :5.000  
      맛2            맛3            가격1           가격2           가격3      
 Min.   :1.50   Min.   :1.500   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.00   1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000  
 Median :3.50   Median :3.500   Median :4.000   Median :4.000   Median :4.000  
 Mean   :3.62   Mean   :3.609   Mean   :3.781   Mean   :3.892   Mean   :3.853  
 3rd Qu.:4.00   3rd Qu.:4.000   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000  
 Max.   :5.00   Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000  
     메뉴1           메뉴2          메뉴3           명성1           명성2      
 Min.   :1.500   Min.   :1.50   Min.   :1.500   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.000   1st Qu.:3.00   1st Qu.:3.500   1st Qu.:3.000   1st Qu.:3.000  
 Median :3.500   Median :3.50   Median :3.500   Median :4.000   Median :4.000  
 Mean   :3.438   Mean   :3.55   Mean   :3.676   Mean   :3.674   Mean   :3.611  
 3rd Qu.:4.000   3rd Qu.:4.00   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :5.000   Max.   :5.00   Max.   :5.000   Max.   :5.000   Max.   :5.000  
     명성3          명성4          외만족1        외만족2         외만족3     
 Min.   :1.00   Min.   :1.000   Min.   :1.00   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.00   1st Qu.:3.000   1st Qu.:3.00   1st Qu.:3.000   1st Qu.:3.000  
 Median :4.00   Median :4.000   Median :3.00   Median :3.250   Median :3.000  
 Mean   :3.71   Mean   :3.709   Mean   :3.47   Mean   :3.516   Mean   :3.481  
 3rd Qu.:4.00   3rd Qu.:4.000   3rd Qu.:4.00   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :5.00   Max.   :5.000   Max.   :5.00   Max.   :5.000   Max.   :5.000  
    외만족4         내만족1         내만족2         내만족3     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000  
 Median :3.500   Median :3.000   Median :3.500   Median :3.000  
 Mean   :3.596   Mean   :3.418   Mean   :3.541   Mean   :3.438  
 3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000  
     신뢰1           신뢰2           신뢰3          재방문1     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000   1st Qu.:3.000  
 Median :3.750   Median :3.000   Median :3.000   Median :4.000  
 Mean   :3.603   Mean   :3.544   Mean   :3.457   Mean   :3.762  
 3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:5.000  
 Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000  
    재방문2         재방문3     
 Min.   :1.000   Min.   :1.000  
 1st Qu.:3.000   1st Qu.:3.000  
 Median :4.000   Median :3.000  
 Mean   :3.703   Mean   :3.155  
 3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :5.000   Max.   :5.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 독립변수 요인 영역 추출</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>independent_vars <span class="ot">&lt;-</span> data[,<span class="dv">2</span><span class="sc">:</span><span class="dv">28</span>]  <span class="co"># 분위기/접근성/편의성/친절도/맛/가격/메뉴</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 종속변수 요인 영역 추출</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>dependent_vars <span class="ot">&lt;-</span> data[,<span class="dv">29</span><span class="sc">:</span><span class="dv">45</span>]  <span class="co"># 명성/외만족/내만족/신뢰/재방문</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="변수에-대한-확인" class="level3" data-number="9.7.3">
<h3 data-number="9.7.3" class="anchored" data-anchor-id="변수에-대한-확인"><span class="header-section-number">9.7.3</span> 변수에 대한 확인</h3>
<p>현재 우리가 가진 데이터는 우리가 직접 만든 데이터가 아닌 누군가에게서 받은 데이터이다. 기본적으로는 어느 카페의 만족도 및 고객인식 조사를 위해 만든 데이터이다. 설문 문항을 만들고 이를 구조화해서 설문을 진행하고 설문한 결과를 데이터로 코딩 한 후에 분석을 하는 일련의 과정은 그냥 아무렇게하면 되는 일이 아니다. 나름의 전문적인 지식을 기반으로 진행해야 하는 일들이다. 이제 우리는 이러한 전문성이 약간 결여 된 상태에서 만들어진 데이터로 분석을 진행할 것이다.</p>
<p>현실의 데이터는 대부분 이런 식이다. 심지어 데이터 자체가 없는 경우도 많다. 따라서 가진 데이터로 최대한 의미있는 결과를 신뢰도 있게 분석하여 전략적 인사이트를 이끌어 내는 것이 핵심이다.</p>
<p><strong>독립변수 후보</strong></p>
<p><strong>-</strong> 분위기: 일반적으로 매장 내의 인테리어나 조명 등을 의미한다. 영어로는 Atmosphere라고도 한다. <br> <strong>-</strong> 접근성: 아마도 카페의 접근성을 의미하는 것으로 판단된다. <br> <strong>-</strong> 편의성: 다소 의미가 애매하다. 카페 매장을 사용하기 편리한지를 의미하는 것으로 생각되지만, 굳이 편의성을 고객에게 물어보아야 하는 것인지 의문이긴 하다. <br> <strong>-</strong> 친절도: 매장 직원의 친절함의 정도를 의미하는 것으로 생각된다. <br> <strong>-</strong> 맛: 커피 및 카페 베이커리 음식의 맛에 대한 질문으로 생각된다. <br> <strong>-</strong> 가격: 커피 및 다른 음식의 가격의 적정성을 묻는 것으로 생각된다. 문제는 고객에게 질문으로 “가격이 적절합니까?”라고 물으면 대부분 부정적인 응답이 나온다. 따라서, 분석결과가 이상하게 나오는 경우가 많다. <br> <strong>-</strong> 메뉴: 보통 메뉴의 다양성을 의미한다. <br></p>
<p>우선 독립변수 후보들을 살펴보면, 이해하기 어려운 변수들이 꽤 많다. <strong>접근성</strong>은 사실상 이미 위치가 정해진 상황이기 때문에 <strong>설문을 통해 분석을 한다 한들 변경하기는 불가능</strong>하다. 여기서 <strong>학술적 분석</strong>과 <strong>비스니스 애널리틱스</strong>의 차이가 발생한다. 학술적으로는 접근성이 낮아 고객이 불편해하고 이때문에 불만족한 것에 대해 분석하고 <strong>통계적 유의성을 논하는 것이 의미있을 수 있다.</strong> 그러나, 비스니스 애널리틱스에서는 설사 유의한 결과가 나온다 하더라도 당장 <strong>전략적 변화를 줄 수 있는 여지가 거의 없다.</strong> 위치적 접근성이 낮아 고객이 불만족하니 카페의 위치를 변경하자고 하는 것은 당장 <strong>실행이 불가능한 판단이다.</strong> 이러한 분석과 결론은 비즈니스 애널리틱스에서는 아무 의미가 없다. 특히, 카페와 같은 리테일 산업에서 위치가 가장 중요하다는 사실은 누구나 아는 사실이다. 다만, 부동산적 가치가 높을 수록 당연히 몫이 좋고 또한 접근성도 좋을 것이기 때문에, 임대료 또한 높을 것이다. 이러한 <strong>임대료 및 위치 변경에 필요한 비용은 감안하지 않고 분석가가 단순하게 접근성이 낮아 고객이 불만족하니 위치를 바꿔야 한다</strong>고 분석하고 결론을 내린다면 이는 기본적인 비즈니스 애널리틱스의 철학을 이해하지 못한 것이다.</p>
<p>이 외에도 간혹 남녀간의 차이를 분석해서 통계적 유의성을 기반으로 비즈니스 전략을 논하는 경우가 많은데, 상당히 위험한 접근이다. 예를 들어, 남성 고객과 여성 고객의 백화점 평균매출이 유의하게 차이가 난다고 가정해 보자. 이 경우 백화점의 매출을 증가시키기 위해 무엇을 해야할까? 남성 고객이 여성 고객보다 평균매출이 낮으므로, 향후에는 남성 고객을 제외하고 여성 고객만을 대상으로 영업을 하자고 하면 말이 될까? 아니면, 모든 남성 고객을 여성으로 변경시키자는 것은 말이 될까? 아니다. 모두 말이 되지 않는다. 현실적으로는 단지 여성 고객들을 대상으로 하는 마케팅을 좀 더 강화하자는 정도가 다일 것이다. 문제는 이러한 접근이 어쩌면 데이터 이면의 보이지 않는 부분을 간과할 수 있다는 것이다. 잘 생각해보자. 무엇이 의미있는 것이고 무엇이 변화 가능한 것인지.</p>
<p>이 외에도 편의성이나 가격처럼 정확하게 무엇을 물어본 것인지 혹은 의미 있는 응답이 가능한 것인지 의문스러운 문항들이 많이 보인다. 물론 비즈니스 애널리틱스에서는 궁금하다면 얼마든지 고객을 대상으로 설문하고 이를 분석할 수 있다. 다만, 중요한 것은 이러한 궁금증이 정말 의미가 있는 것인지, 아니면 단순히 분석가나 마케팅 담당자의 호기심인지 구분해야한다.</p>
<p><strong>종속변수 후보</strong></p>
<p><strong>-</strong> 명성: 흔히 reputation이라고 하는 것인데, 명성을 고객에게 물어서 확인한다는 것은 좀 문제가 있어 보인다. <br> <strong>-</strong> 외만족 &amp; 내만족: 도대체 무슨 의미로 내만족과 외만족을 구분한 것인지 알기는 어렵다. 뭔가 독특한 이유가 있었을 것으로 생각되지만 일반적이라고 보긴 조금 어렵다. 이런 경우 모두를 “만족”으로 묶어서 보아야 할 것이다. <br> <strong>-</strong> 신뢰: 고객이 해당 카페를 얼마나 믿을 수 있는지에 대한 변수이다. B2B에서 많이 관심을 갖는 변수이고 B2C에서도 간혹 사용되기는 하지만 보통 신뢰, 만족, 충성도 사이의 인과관계를 구축하는 것이 쉽지는 않다. <br> <strong>-</strong> 재방문: 고객이 다시 방문할 의도가 있는지 묻는 질문이다. <br></p>
</section>
<section id="요인분석-수행" class="level3" data-number="9.7.4">
<h3 data-number="9.7.4" class="anchored" data-anchor-id="요인분석-수행"><span class="header-section-number">9.7.4</span> 요인분석 수행</h3>
<p>요인 수 결정은 고유값 1 기준(Eigen value &gt; 1) 또는 Scree Plot을 기반으로 수행하며, 우선, 7개의 모든 변수를 다 넣고 요인분석을 실행해 보기로 하자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(independent_vars, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  6  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. 모든 독립변수에 대한 요인분석</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(independent_vars, <span class="at">nfactors =</span> <span class="dv">7</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result<span class="sc">$</span>loadings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
        PA2    PA3    PA1    PA5    PA4    PA6    PA7   
분위기1  0.107                0.129  0.252  0.137  0.666
분위기2  0.105  0.271  0.250  0.150  0.456         0.482
분위기3  0.186  0.170  0.242  0.190  0.747  0.126  0.174
분위기4  0.123  0.272  0.227  0.201  0.756  0.119  0.205
분위기5  0.177  0.270  0.356  0.239  0.532  0.164  0.231
접근성1  0.166  0.200  0.753  0.179  0.302              
접근성2  0.193  0.240  0.739  0.171  0.213  0.140       
접근성3  0.248  0.221  0.636  0.309  0.186  0.197       
접근성4  0.253  0.123  0.504  0.389  0.114  0.296  0.152
편의성1  0.148  0.519  0.333  0.364  0.127         0.180
편의성2         0.829  0.103  0.173  0.119  0.118       
편의성3  0.144  0.754  0.247  0.234  0.204              
편의성4  0.119  0.772  0.160  0.219  0.199  0.138       
친절도1  0.187  0.337  0.205  0.511  0.236              
친절도2         0.228         0.552  0.114         0.176
친절도3  0.244  0.196  0.265  0.671                     
친절도4  0.231  0.235  0.303  0.540  0.304  0.252       
친절도5  0.200  0.232  0.260  0.451  0.237  0.329       
맛1      0.763         0.143  0.140  0.103              
맛2      0.788  0.139  0.126         0.118              
맛3      0.742         0.114  0.103                     
가격1    0.413  0.194  0.179  0.177  0.141  0.576       
가격2    0.398  0.122  0.189  0.208  0.170  0.628       
가격3    0.443  0.185  0.244  0.180         0.548  0.161
메뉴1    0.723  0.147                0.102  0.274       
메뉴2    0.735  0.134         0.166         0.154  0.105
메뉴3    0.670         0.153                0.205       

                 PA2   PA3   PA1   PA5   PA4   PA6   PA7
SS loadings    4.343 2.996 2.770 2.446 2.306 1.654 0.966
Proportion Var 0.161 0.111 0.103 0.091 0.085 0.061 0.036
Cumulative Var 0.161 0.272 0.374 0.465 0.550 0.612 0.647</code></pre>
</div>
</div>
<p>우선 Scree plot과 SS loadings값을 보면 잘해야 6개 정도의 요인이 존재한다고 볼 수 있다. 위에서 보면 가격이 가장 이상하게 묶이고 있다는 점을 확인할 수 있다. 이제 가격을 제외하고 다시 요인분석을 해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 독립변수 요인 영역에서 가격 제거</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>independent_vars1 <span class="ot">&lt;-</span> independent_vars[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>)]  <span class="co"># 분위기/접근성/편의성/친절도/가격/메뉴</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(independent_vars1, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  5  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. 모든 독립변수에 대한 요인분석</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>fa_result1 <span class="ot">&lt;-</span> <span class="fu">fa</span>(independent_vars1, <span class="at">nfactors =</span> <span class="dv">6</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result1<span class="sc">$</span>loadings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
        PA2    PA3    PA1    PA5    PA4    PA6   
분위기1  0.121                0.163  0.179  0.615
분위기2         0.278  0.261  0.133  0.316  0.608
분위기3  0.191  0.189  0.275  0.207  0.669  0.312
분위기4  0.128  0.282  0.247  0.221  0.723  0.323
분위기5  0.186  0.273  0.370  0.274  0.493  0.304
접근성1  0.167  0.204  0.765  0.198  0.241  0.141
접근성2  0.201  0.244  0.764  0.195  0.155       
접근성3  0.260  0.221  0.640  0.350  0.174       
접근성4  0.279  0.123  0.506  0.445  0.101  0.148
편의성1  0.146  0.509  0.320  0.379  0.100  0.177
편의성2  0.101  0.830  0.116  0.194              
편의성3  0.146  0.761  0.256  0.247  0.173       
편의성4  0.128  0.775  0.169  0.246  0.176       
친절도1  0.185  0.345  0.214  0.503  0.193       
친절도2         0.226         0.566         0.201
친절도3  0.242  0.201  0.257  0.658              
친절도4  0.254  0.241  0.320  0.586  0.279       
친절도5  0.232  0.237  0.288  0.505  0.199  0.135
맛1      0.756         0.136  0.137  0.115       
맛2      0.774  0.140  0.121         0.143       
맛3      0.744         0.114  0.109              
메뉴1    0.751  0.157  0.104  0.137         0.134
메뉴2    0.750  0.135         0.186         0.133
메뉴3    0.694         0.170  0.114              

                 PA2   PA3   PA1   PA5   PA4   PA6
SS loadings    3.941 2.954 2.781 2.622 1.760 1.256
Proportion Var 0.164 0.123 0.116 0.109 0.073 0.052
Cumulative Var 0.164 0.287 0.403 0.512 0.586 0.638</code></pre>
</div>
</div>
<p>위의 결과에서 로딩값을 확인해보면, 분위기의 경우 5개의 변수가 이상하게 묶여있다는 점을 알 수 있다. 분위기1과 2는 PA6에, 나머지는 PA4에 묶여있다. 이건 어느 한 요인으로 묶였다고 말하기 어려운 상탱리다. 접근성은 이보다 훨씬 낫다. PA1에 확실하게 묶여있다. 편의성은 PA3에 묶여있고, 친절도는 PA5에 묶여 있다고 보아야 하긴 하나 전반적으로 로딩값이 그리 높지 않다. 가장 큰 문제는 맛과 메뉴인데, 둘 다 PA2에 너무 강하게 묶여있다. 이제 우리는 결정을 해야한다. 이 경우 누구를 먼저 버려야할까? 이는 전적으로 분석가의 몫이긴 하나, 나라면 여기서 메뉴를 버리겠다. 맛과 메뉴 중에 누가 더 중요하겠는가라고 묻는다면 나는 맛을 우선시 하겠다. 여러분은 여러분 나름대로 판단하길 바란다. 다양하게 분석을 해봐야 경험이 쌓이고, 이 경험이 여러분의 분석능력에 도움이 된다.</p>
<p>이제 다시 메뉼를 버리고, 요인분석을 해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 독립변수 요인 영역에서 가격 제거</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>independent_vars2 <span class="ot">&lt;-</span> independent_vars1[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>)]  <span class="co"># 분위기/접근성/편의성/친절도/가격</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(independent_vars2, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  5  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. 모든 독립변수에 대한 요인분석</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>fa_result2 <span class="ot">&lt;-</span> <span class="fu">fa</span>(independent_vars2, <span class="at">nfactors =</span> <span class="dv">5</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result2<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
        PA4    PA3    PA1    PA5    PA2   
분위기1         0.530                     
분위기2         0.646                     
분위기3         0.716                     
분위기4         0.753                     
분위기5         0.605                     
접근성1                0.765              
접근성2                0.765              
접근성3                0.650              
접근성4                0.496  0.453       
편의성1  0.497                            
편의성2  0.832                            
편의성3  0.764                            
편의성4  0.777                            
친절도1                       0.489       
친절도2                       0.574       
친절도3                       0.655       
친절도4                       0.560       
친절도5                       0.503       
맛1                                  0.743
맛2                                  0.818
맛3                                  0.773

                 PA4   PA3   PA1   PA5   PA2
SS loadings    2.920 2.833 2.768 2.483 2.240
Proportion Var 0.139 0.135 0.132 0.118 0.107
Cumulative Var 0.139 0.274 0.406 0.524 0.631</code></pre>
</div>
</div>
<p>cutoff값을 0.4로 잡으니 결과가 매우 깔끔하게 나왔다. 이 경우 이상태 그래도 진행해도 되겠지만, 조금 아쉬운 부분이 있다. 분위기 1, 접근성 4, 편의성 1, 친절도 1은 그다지 훌륭한 로딩값은 아니라는 생각이 든다. 이제 위의 4 개의 변수를 제거하고 다시 요인분석을 해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 독립변수 요인 영역에서 가격 제거</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>independent_vars3 <span class="ot">&lt;-</span> independent_vars2[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">14</span>)]  <span class="co"># 분위기/접근성/편의성/친절도/가격</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(independent_vars3, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  5  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. 모든 독립변수에 대한 요인분석</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>fa_result3 <span class="ot">&lt;-</span> <span class="fu">fa</span>(independent_vars3, <span class="at">nfactors =</span> <span class="dv">5</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result3<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
        PA1   PA3   PA2   PA4   PA5  
분위기2 0.587                        
분위기3 0.760                        
분위기4 0.838                        
분위기5 0.627                        
접근성1                   0.766      
접근성2                   0.761      
접근성3                   0.587      
편의성2       0.797                  
편의성3       0.753                  
편의성4       0.778                  
친절도2                         0.569
친절도3                         0.614
친절도4                         0.622
친절도5                         0.545
맛1                 0.747            
맛2                 0.825            
맛3                 0.774            

                 PA1   PA3   PA2   PA4   PA5
SS loadings    2.713 2.298 2.190 2.104 2.006
Proportion Var 0.160 0.135 0.129 0.124 0.118
Cumulative Var 0.160 0.295 0.424 0.547 0.665</code></pre>
</div>
</div>
<p>이제 위의 5개의 변수를 요인으로 묶어 회귀분석을 하기도 하자. 이를 위해 위의 요인들에 대해 각 응답자의 응답에 대한 요인점수를 만들어야 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 요인점수 계산 및 확인</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>ind_scores <span class="ot">&lt;-</span> <span class="fu">factor.scores</span>(independent_vars3, fa_result3, <span class="at">method =</span> <span class="st">"regression"</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ind_scores<span class="sc">$</span>scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PA1        PA3         PA2         PA4        PA5
[1,]  2.1592311 -0.2798295 -1.16709611 -0.52645038 -0.1307781
[2,]  1.4175441 -0.6668486 -0.13365840  1.12020905  0.6539308
[3,]  0.6209099 -0.4325822 -1.29437620  0.04631345  0.1637881
[4,] -0.1559034 -0.2676424 -0.14376152 -1.00603934 -1.0950011
[5,] -0.9550134 -1.0785734  0.02038035  0.99932440 -0.2617141
[6,] -0.3055364  0.3248672 -0.90816053 -0.37419685 -0.5562861</code></pre>
</div>
</div>
<p>문제없이 요인점수가 계산되었으므로 요인점수만을 별도의 데이터로 저장해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인점수 저장</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>data_fa <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, ind_scores<span class="sc">$</span>scores)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인점수 변수 이름 정리</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_fa)[(<span class="fu">ncol</span>(data_fa)<span class="sc">-</span><span class="dv">4</span>)<span class="sc">:</span><span class="fu">ncol</span>(data_fa)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"fa_atmosphere"</span>, <span class="st">"fa_convenience"</span>, <span class="st">"fa_taste"</span>, <span class="st">"fa_access"</span>, <span class="st">"fa_kind"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>그러면 이제, 종속변수의 부분을 보도록 하자. 종속변수 그룹에는 명성/외만족/내만족/신뢰/재방문의 총 5개의 변수가 있었지만 내만족과 외만족을 합쳐서 본다고 하면 4개의 요인이 나올 것으로 예상된다. 과연 그런지 보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(dependent_vars, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  3  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. 모든 독립변수에 대한 요인분석</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>fa_result_de <span class="ot">&lt;-</span> <span class="fu">fa</span>(dependent_vars, <span class="at">nfactors =</span> <span class="dv">4</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result_de<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
        PA2   PA1   PA4   PA3  
명성1         0.712            
명성2         0.752            
명성3         0.737            
명성4         0.698            
외만족1 0.725                  
외만족2 0.805                  
외만족3 0.811                  
외만족4 0.731                  
내만족1 0.525                  
내만족2 0.526                  
내만족3 0.534                  
신뢰1   0.423       0.585      
신뢰2               0.708      
신뢰3         0.458 0.584      
재방문1       0.475       0.586
재방문2                   0.883
재방문3                        

                 PA2   PA1  PA4   PA3
SS loadings    4.209 3.609 2.21 1.972
Proportion Var 0.248 0.212 0.13 0.116
Cumulative Var 0.248 0.460 0.59 0.706</code></pre>
</div>
</div>
<p>다른 것 보다도 신뢰가 엉망이다. B2C에서는 신뢰라는 변수가 매우 민감한 변수이다. 만약 고객이 음식점이나 카페에 대한 신뢰에 문제가 있다면 이는 심각한 수준의 식중독 사건이나 혹은 사회적 물의를 일으킬 정도의 사건이 아니라면 쉽게 반응하지 않는 변수이기 때문에 제거하고 다시 요인분석을 해보도록 하자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 종속변수 요인 영역에서 신뢰 제거</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>dependent_vars1 <span class="ot">&lt;-</span> dependent_vars[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>)]</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(dependent_vars1, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  3  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. 모든 독립변수에 대한 요인분석</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>fa_result_de1 <span class="ot">&lt;-</span> <span class="fu">fa</span>(dependent_vars1, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result_de1<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
        PA2   PA1   PA3  
명성1         0.728      
명성2         0.762      
명성3         0.734      
명성4         0.701      
외만족1 0.729            
외만족2 0.808            
외만족3 0.830            
외만족4 0.766            
내만족1 0.569            
내만족2 0.588 0.406      
내만족3 0.586            
재방문1       0.469 0.681
재방문2             0.849
재방문3             0.449

                 PA2   PA1   PA3
SS loadings    4.195 3.314 2.229
Proportion Var 0.300 0.237 0.159
Cumulative Var 0.300 0.536 0.696</code></pre>
</div>
</div>
<p>대략 모양은 갖추어졌다. 다만 좀 문제가 있다. 우리가 뒤에서 하려고 하는 것은 앞서 회귀분석에서 배웠던 매개효과를 시도해보려 하는 것이기 때문이다. 이제 위의 세 개의 변수 중 두 개만 골라내야 한다. 무엇이 좋을까? 나는 명성을 제거하는 방향으로 결정을 내리겠다. 명성이라는 것이 다소 문제가 되는 이유는 예를 들어 고객이 만족해서 명성이 생긴 것인지 아니면 명성이 높아서 고객이 방문한 것인지에 따라 인과관계가 애매할 수 있기 때문이다. 이제 단순하게 만족과 재방문을 넣어서 다시 요인분석을 시행해 보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 종속변수 요인 영역에서 신뢰뢰 제거</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>dependent_vars2 <span class="ot">&lt;-</span> dependent_vars1[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)]</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(dependent_vars2, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  3  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. 모든 독립변수에 대한 요인분석</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>fa_result_de2 <span class="ot">&lt;-</span> <span class="fu">fa</span>(dependent_vars2, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result_de2<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
        PA1   PA2  
외만족1 0.748      
외만족2 0.825      
외만족3 0.846      
외만족4 0.765      
내만족1 0.588 0.439
내만족2 0.607 0.556
내만족3 0.615 0.403
재방문1       0.824
재방문2       0.873
재방문3       0.561

                 PA1   PA2
SS loadings    3.944 2.813
Proportion Var 0.394 0.281
Cumulative Var 0.394 0.676</code></pre>
</div>
</div>
<p>그렇다. 여전히 다른 문제가 있다. 내만족이 양쪽 요인에 모두 묶이는 상황이다. 당연히 내만족을 제거하는 것이 논리적이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 종속변수 요인 영역에서 신뢰뢰 제거</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>dependent_vars3 <span class="ot">&lt;-</span> dependent_vars2[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>)]</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 적정 요인 개수 확인: Scree plot</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(dependent_vars3, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter9_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  2  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. 모든 독립변수에 대한 요인분석</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>fa_result_de3 <span class="ot">&lt;-</span> <span class="fu">fa</span>(dependent_vars3, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"pa"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result_de3<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
        PA1   PA2  
외만족1 0.762      
외만족2 0.847      
외만족3 0.859      
외만족4 0.751      
재방문1       0.795
재방문2       0.927
재방문3       0.553

                 PA1   PA2
SS loadings    2.911 2.196
Proportion Var 0.416 0.314
Cumulative Var 0.416 0.730</code></pre>
</div>
</div>
<p>어떤가? 매우 깔끔하다. 이제 위의 두 요인을 요인점수로 해서 변수로 넣어 보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 요인점수 계산 및 확인</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>dv_scores <span class="ot">&lt;-</span> <span class="fu">factor.scores</span>(dependent_vars3, fa_result_de3, <span class="at">method =</span> <span class="st">"regression"</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dv_scores<span class="sc">$</span>scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PA1          PA2
[1,] -0.6360628  1.311082453
[2,] -0.4403152 -0.671032905
[3,] -0.4173551 -0.636817476
[4,] -0.7401045 -0.530657371
[5,]  1.0625273  0.006236659
[6,] -0.2527380 -0.710811212</code></pre>
</div>
</div>
<p>문제없이 요인점수가 계산되었으므로 요인점수만을 별도의 데이터로 저장해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인점수 저장</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>data_fa <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_fa, dv_scores<span class="sc">$</span>scores)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인점수 변수 이름 정리</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_fa)[(<span class="fu">ncol</span>(data_fa)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">ncol</span>(data_fa)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"fa_satisfaction"</span>, <span class="st">"fa_revisit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="매개효과-검증-독립변수들---만족---재방문" class="level3" data-number="9.7.5">
<h3 data-number="9.7.5" class="anchored" data-anchor-id="매개효과-검증-독립변수들---만족---재방문"><span class="header-section-number">9.7.5</span> 매개효과 검증: 독립변수들 -&gt; 만족 -&gt; 재방문</h3>
<p>간접효과를 확인하기 위해 요인점수를 기반으로 경로 분석을 수행할 수 있다. 이때, 구조방정식모형(SEM) 분석을 활용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lavaan' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lavaan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:psych':

    cor2cov</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 예시 모형: 독립변수들 -&gt; 만족 -&gt; 재방문</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'fa_satisfaction ~ fa_atmosphere + fa_convenience + fa_taste + fa_access + fa_kind</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="st">          fa_revisit ~ fa_satisfaction + fa_atmosphere + fa_convenience + fa_taste + fa_access + fa_kind'</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> data_fa)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                           416

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  fa_satisfaction ~                                                      
    fa_atmosphere      0.189    0.044    4.274    0.000    0.189    0.183
    fa_convenience     0.213    0.044    4.794    0.000    0.213    0.205
    fa_taste           0.196    0.044    4.427    0.000    0.196    0.189
    fa_access          0.159    0.045    3.504    0.000    0.159    0.150
    fa_kind            0.300    0.050    5.960    0.000    0.300    0.258
  fa_revisit ~                                                           
    fa_satisfactin    -0.269    0.046   -5.790    0.000   -0.269   -0.266
    fa_atmosphere      0.292    0.043    6.805    0.000    0.292    0.279
    fa_convenience     0.297    0.043    6.880    0.000    0.297    0.284
    fa_taste           0.329    0.043    7.659    0.000    0.329    0.314
    fa_access          0.162    0.044    3.697    0.000    0.162    0.151
    fa_kind            0.348    0.050    6.992    0.000    0.348    0.295

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .fa_satisfactin    0.675    0.047   14.422    0.000    0.675    0.755
   .fa_revisit        0.607    0.042   14.422    0.000    0.607    0.663</code></pre>
</div>
</div>
<p>위의 결과를 해석해 보라. 위에서는 Baron &amp; Kenny의 3단계중 1단계와 3단계만 테스트 하였다. 굳이 2단계는 의미가 없기 때문이다.</p>
<p>독립변수 분위기, 편의성, 맛, 접근성, 친절도가 높을 수록 모두 유의하게 고객만족을 높이고 있다. 문제는 다음 단계에서 고객만족이 높을 수록 고객들은 재방문을 하려하지 않는다는 유의한 결과나 나왔다. 논리적으로 전혀 말이 되지 않는다. 왜 이런 결과가 나왔을까?</p>
<p><strong>문제의 원인을 파악하고 다시 분석하여 의미있는 결과를 도출해보라.</strong></p>
<p><strong>[과제]</strong> 위의 비논리적 결과의 원인을 분석하고 원인을 해결하여 다시 분석하여 제대로된 의미있는 결과를 도출 하시오.</p>
</section>
<section id="실습-마무리-요약" class="level3" data-number="9.7.6">
<h3 data-number="9.7.6" class="anchored" data-anchor-id="실습-마무리-요약"><span class="header-section-number">9.7.6</span> 실습 마무리 요약</h3>
<p>이번 실습에서는 커피전문점 설문 데이터를 기반으로 요인분석을 통해 다수의 문항을 축소하고, 요인점수를 활용한 회귀분석과 매개효과 분석까지 전체 분석 흐름을 경험하였다. 요인분석은 해석 가능한 요인을 추출하여 복잡한 데이터를 단순화하고, 이후 다양한 통계모형에 활용 가능하게 한다는 점에서 외식산업 실무와 연구에 매우 유용한 도구이다.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter8.html" class="pagination-link  aria-label=" &lt;span="" 주성분="" 분석&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">차원축소와 주성분 분석</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter10.html" class="pagination-link" aria-label="<span class='chapter-number'>10</span>&nbsp; <span class='chapter-title'>계층적 군집분석</span>">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">계층적 군집분석</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>